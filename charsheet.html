<input type="radio" name="sheet" value="View" checked class="sheet-sheetsel sheet-viewsel"><div class="pilltext">View</div>
<input type="radio" name="sheet" value="Input" class="sheet-sheetsel sheet-inputsel"><div class="pilltext">Input</div>
<input type="radio" name="sheet" value="Ship" class="sheetsel sheet-shipsel"><div class="pilltext">Ship</div>
<input type="radio" name="sheet" value="Conditions" class="sheetsel"><div class="pilltext">Conditions</div>


<input name="attr_talentstring" type="text" value="" style="display: none;">





<div class="sheet-viewwrapper">
    <!--First Row -->
    <div class="sheet-3colrow">
        <div class='sheet-col sheet-playerfill'>
            <div class="sheet-row">
                <div class="sheet-item" style="width:40%"><span>Character Name:</span></div>
                <div class="sheet-item" style="width:54%"><input name="attr_charname" type="text" value="N/A" style="width:100%"></div>
            </div>
            <div class="sheet-row">
                <div class="sheet-item" style="width:40%"><span>Homeworld:</span></div>
                <div class="sheet-item" style="width:54%"><input name="attr_homeworld" type="text" value="N/A" style="width:100%"></div>
            </div>
            <div class="sheet-row">
                <div class="sheet-item" style="width:40%"><span>Background:</span></div>
                <div class="sheet-item" style="width:54%"><input name="attr_background" type="text" value="N/A" style="width:100%"></div>
            </div>  
            <div class="sheet-row">
                <div class="sheet-item" style="width:40%"><span>Role:</span></div>
                <div class="sheet-item" style="width:54%"><input name="attr_role" type="text" value="N/A" style="width:100%"></div>
            </div>  
            <div class="sheet-row">
                <div class="sheet-item" style="width:40%"><span>Player Name:</span></div>
                <div class="sheet-item" style="width:54%"><input name="attr_playername" type="text" value="N/A" style="width:100%"></div>
            </div>  
        </div>      
        <div class='sheet-col'>          
        </div>      
        <div class='sheet-col'>
            <div class="sheet-row">
                <div class="sheet-item" style="width:30%"><span>Wounds:</span></div>
                <div class="sheet-item" style="width:5%"><span name="attr_CurWounds"></span></div>
                <div class="sheet-item" style="width:1%"><span>/</span></div>
                <div class="sheet-item" style="width:5%"><span name="attr_MaxWounds"></span></div>
            </div>
            <div class="sheet-row">
                <div class="sheet-item" style="width:30%"><span>Fate Points:</span></div>
                <div class="sheet-item" style="width:5%"><span name="attr_CurFatePoints"></span></div>
                <div class="sheet-item" style="width:1%"><span>/</span></div>
                <div class="sheet-item" style="width:5%"><span name="attr_MaxFatePoints"></span></div>
            </div>
            <div class="sheet-row">
                <div class="sheet-item" style="width:30%"><span>Fatigue:</span></div>
                <div class="sheet-item" style="width:5%"><span name="attr_CurFatigue"></span></div>
                <div class="sheet-item" style="width:1%"><span>/</span></div>
                <div class="sheet-item" style="width:5%"><input name="attr_dispWeaponSkill" type="number" value="@{ToughnessMod}+@{WillpowerMod}" class='sheet-cell' disabled="true"></div>
            </div>  
            <div class="sheet-row">
                <div class="sheet-item" style="width:30%"><span>Movement:</span></div>
                <div class="sheet-item" style="width:8%"><input name="attr_halfmovespeed" type="number" value="(@{AgilityMod})" class='sheet-cell' disabled="true"></div>
                <div class="sheet-item" style="width:1%"><span>/</span></div>
                <div class="sheet-item" style="width:8%"><input name="attr_fullmovespeed" type="number" value="2*(@{AgilityMod})" class='sheet-cell' disabled="true"></div>
                <div class="sheet-item" style="width:1%"><span>/</span></div>
                <div class="sheet-item" style="width:8%"><input name="attr_chargespeed" type="number" value="3*(@{AgilityMod})" class='sheet-cell' disabled="true"></div>
                <div class="sheet-item" style="width:1%"><span>/</span></div>
                <div class="sheet-item" style="width:8%"><input name="attr_runspeed" type="number" value="6*(@{AgilityMod})" class='sheet-cell' disabled="true"></div>
            </div>  
            <div class="sheet-row">
                <div class="sheet-item" style="width:30%"><span>Weight:</span></div>
                <div class="sheet-item" style="width:8%"><span name="attr_CurCapacity"></span></div>
                <div class="sheet-item" style="width:1%"><span>/</span></div>
                <div class="sheet-item" style="width:8%"><span name="attr_MaxCapacity"></span></div>
            </div>  
        </div>
    </div>
    
    <!--Second Row -->
    
    <div class="sheet-2colrow">
        <div class='sheet-col'>
            <div class="sheet-row sheet-header">
                <div class="sheet-item" style="width:100%"><h4>Characteristics</h4></div>
            </div>
            <div class="sheet-row sheet-characteristics">
                <div class="sheet-item sheet-adj" style="width:35%"><span style="float:right">Weapon Skill (WS)</span></div>
                <button type='roll' value='!skill40k @{charname},@{dispWeaponSkill},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60}, Weapon Skill, stat' name='roll_WeaponSkill' class="lefthiddenroll"></button>
                <div class="sheet-item" style="width:10%"><input name="attr_dispWeaponSkill" type="text" value="@{WeaponSkill}+@{WeaponSkillAdj}" class='sheet-cell sheet-charnum sheet-spindisable' disabled="true"></div>
                <div class="sheet-item" style="width:5%"><span></span></div>
                <div class="sheet-item" style="width:10%"><input name="attr_dispIntelligence" type="text" value="@{Intelligence}+@{IntelligenceAdj}" class='sheet-cell sheet-charnum sheet-spindisable' disabled="true"></div>
                <button type='roll' value='!skill40k @{charname},@{dispIntelligence},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60}, Intelligence, stat' name='roll_Intelligence' class="righthiddenroll"></button>
                <div class="sheet-item sheet-adj" style="width:35%"><span style="float:left">Intelligence (INT)</span></div>
            </div>
            <div class="sheet-row sheet-characteristics">
                <div class="sheet-item" style="width:35%"><span style="float:right">Ballistic Skill (BS)</span></div>
                <button type='roll' value='!skill40k @{charname},@{dispBallisticSkill},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60}, Ballistic Skill, stat' name='roll_BallisticSkill' class="lefthiddenroll"></button>
                <div class="sheet-item" style="width:10%"><input name="attr_dispBallisticSkill" type="text" value="@{BallisticSkill}+@{BallisticSkillAdj}" class='sheet-cell sheet-charnum sheet-spindisable' disabled="true"></div>
                <div class="sheet-item" style="width:5%"><span></span></div>
                <div class="sheet-item" style="width:10%"><input name="attr_dispPerception" type="text" value="@{Perception}+@{PerceptionAdj}" class='sheet-cell sheet-charnum sheet-spindisable' disabled="true"></div>
                <button type='roll' value='!skill40k @{charname},@{dispPerception},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60}, Perception, stat' name='roll_Perception' class="righthiddenroll"></button>
                <div class="sheet-item" style="width:35%"><span style="float:left">Perception (PER)</span></div>
            </div>
            <div class="sheet-row sheet-characteristics">
                <div class="sheet-item" style="width:35%"><span style="float:right">Strength (S)</span></div>
                <button type='roll' value='!skill40k @{charname},@{dispStrength},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60}, Strength, stat' name='roll_Strength' class="lefthiddenroll"></button>
                <div class="sheet-item" style="width:10%"><input name="attr_dispStrength" type="text" value="@{Strength}+@{StrengthAdj}" class='sheet-cell sheet-charnum sheet-spindisable' disabled="true"></div>
                <div class="sheet-item" style="width:5%"><span></span></div>
                <div class="sheet-item" style="width:10%"><input name="attr_dispWillpower" type="text" value="@{Willpower}+@{WillpowerAdj}" class='sheet-cell sheet-charnum sheet-spindisable' disabled="true"></div>
                <button type='roll' value='!skill40k @{charname},@{dispWillpower},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60}, Willpower, stat' name='roll_Willpower' class="righthiddenroll"></button>
                <div class="sheet-item" style="width:35%"><span style="float:left">Willpower (WP)</span></div>
            </div>
            <div class="sheet-row sheet-characteristics">
                <div class="sheet-item" style="width:35%"><span style="float:right">Toughness (T)</span></div>
                <button type='roll' value='!skill40k @{charname},@{dispToughness},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60}, Toughness, stat' name='roll_Toughness' class="lefthiddenroll"></button>
                <div class="sheet-item" style="width:10%"><input name="attr_dispToughness" type="text" value="@{Toughness}+@{ToughnessAdj}" class='sheet-cell sheet-charnum sheet-spindisable' disabled="true"></div>
                <div class="sheet-item" style="width:5%"><span></span></div>
                <div class="sheet-item" style="width:10%"><input name="attr_dispFellowship" type="text" value="@{Fellowship}+@{FellowshipAdj}" class='sheet-cell sheet-charnum sheet-spindisable' disabled="true"></div>
                <button type='roll' value='!skill40k @{charname},@{dispFellowship},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60}, Fellowship, stat' name='roll_Fellowship' class="righthiddenroll"></button>
                <div class="sheet-item" style="width:35%"><span style="float:left">Fellowship (FEL)</span></div>
            </div>
            <div class="sheet-row sheet-characteristics">
                <div class="sheet-item" style="width:35%"><span style="float:right">Agility (AG)</span></div>
                <button type='roll' value='!skill40k @{charname},@{dispAgility},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60}, Agility, stat' name='roll_Agility' class="lefthiddenroll"></button>
                <div class="sheet-item" style="width:10%"><input name="attr_dispAgility" type="text" value="@{Agility}+@{AgilityAdj}" class='sheet-cell sheet-charnum sheet-spindisable' disabled="true"></div>
                <div class="sheet-item" style="width:5%"><span></span></div>
                <div class="sheet-item" style="width:10%"><input name="attr_dispInfluence" type="text" value="@{Influence}+@{InfluenceAdj}" class='sheet-cell sheet-charnum sheet-spindisable' disabled="true"></div>
                <button type='roll' value='!skill40k @{charname},@{dispInfluence},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60}, Influence, stat' name='roll_Influence' class="righthiddenroll"></button>
                <div class="sheet-item" style="width:35%"><span style="float:left">Influence (IFL)</span></div>
            </div>
        </div>
        <div class='sheet-col sheet-skills'>
            <div class="sheet-row">
                <div class="sheet-item" style="width:100%"><h4>Skills</h4></div>
            </div>
            <div class="sheet-2colrow" style="padding-top: 5px">
				<div class='sheet-col'>
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:40%"><span>Acrobatics (Ag)</span></div>
                        <div class="sheet-item" style="width:15%"><span name="attr_AcrobaticsScore"></span></div>
                        <!--<div class="sheet-item" style="width:15%; position:relative"><button class='skillchal' type='roll' value='!skill40k @{charname},@{AcrobaticsScore},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60},Acrobatics, skill' name='roll_AcrobaticsCheck'></button><span class="skillchal"></span></div>
                        --><div class="sheet-item" style="width:10%;"><button type='roll' value='!skill40k @{charname},@{AcrobaticsScore},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60},Acrobatics, skill' name='roll_AcrobaticsCheck'></button></div>
                   
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:70%"><span>Athletics (S)</span></div>
                        <div class="sheet-item" style="width:15%"><span name="attr_AthleticsScore"></span></div>
                        <div class="sheet-item" style="width:10%"><button type='roll' value='!skill40k @{charname},@{AthleticsScore},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60},Athletics, skill' name='roll_AthleticsCheck'></button></div>
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:70%"><span>Awareness (Per)</span></div>
                        <div class="sheet-item" style="width:15%"><span name="attr_AwarenessScore"></span></div>
                        <div class="sheet-item" style="width:10%"><button type='roll' value='!skill40k @{charname},@{AwarenessScore},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60},Awareness, skill' name='roll_AwarenessCheck'></button></div>
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:70%"><span>Charm (Fel)</span></div>
                        <div class="sheet-item" style="width:15%"><span name="attr_CharmScore"></span></div>
                        <div class="sheet-item" style="width:10%"><button type='roll' value='!skill40k @{charname},@{CharmScore},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60},Charm, skill' name='roll_CharmCheck'></button></div>
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:70%"><span>Command (Fel)</span></div>
                        <div class="sheet-item" style="width:15%"><span name="attr_CommandScore"></span></div>
                        <div class="sheet-item" style="width:10%"><button type='roll' value='!skill40k @{charname},@{CommandScore},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60},Command, skill' name='roll_CommandCheck'></button></div>
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:70%"><span>Commerce (Int)</span></div>
                        <div class="sheet-item" style="width:15%"><span name="attr_CommerceScore"></span></div>
                        <div class="sheet-item" style="width:10%"><button type='roll' value='!skill40k @{charname},@{CommerceScore},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60},Commerce, skill' name='roll_CommerceCheck'></button></div>
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:70%"><span>Common Lore (Int)</span></div>
                    </div>
                    <fieldset class="repeating_cldisps">
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:0%"><input name="attr_dispcommonlorenames" type="text" value="" class='sheet-cell' style="display: none;"></div>
                        <div class="sheet-item" style="width:60%"><input name="attr_vdispcommonlorenames" type="text" value="@{dispcommonlorenames}" disabled="true" class='sheet-cell'></div>
                        <div class="sheet-item" style="width:14%"><input name="attr_vdispcommonlorescores" type="number" value="@{dispcommonlorescores}" disabled="true" class='sheet-cell'></div>
                        <div class="sheet-item" style="width:0%"><input name="attr_dispcommonlorescores" type="number" value="" class='sheet-cell' style="display: none;"></div>
                        <div class="sheet-item" style="width:10%"><button type='roll' value='!skill40k @{charname},@{dispcommonlorescores},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60},Common Lore: @{dispcommonlorenames}, skill' name='roll_CommonLoreCheck'></button></div>
                    </div>
                    </fieldset>
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:70%"><span>Deceive (Fel)</span></div>
                        <div class="sheet-item" style="width:15%"><span name="attr_DeceiveScore"></span></div>
                        <div class="sheet-item" style="width:10%"><button type='roll' value='!skill40k @{charname},@{DeceiveScore},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60},Deceive, skill' name='roll_DeceiveCheck'></button></div>
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:70%"><span>Dodge (Ag)</span></div>
                        <div class="sheet-item" style="width:15%"><span name="attr_DodgeScore"></span></div>
                        <div class="sheet-item" style="width:10%"><button type='roll' value='!skill40k @{charname},@{DodgeScore},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60},Dodge, skill' name='roll_DodgeCheck'></button></div>
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:70%"><span>Forbidden Lore (Int)</span></div>
                    </div>
                    <fieldset class="repeating_fldisps">
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:0%"><input name="attr_dispforbiddenlorenames" type="text" value="" class='sheet-cell' style="display: none;"></div>
                        <div class="sheet-item" style="width:60%"><input name="attr_vdispforbiddenlorenames" type="text" value="@{dispforbiddenlorenames}" disabled="true" class='sheet-cell'></div>
                        <div class="sheet-item" style="width:14%"><input name="attr_vdispforbiddenlorescores" type="number" value="@{dispforbiddenlorescores}" disabled="true" class='sheet-cell'></div>
                        <div class="sheet-item" style="width:0%"><input name="attr_dispforbiddenlorescores" type="number" value="" class='sheet-cell' style="display: none;"></div>
                        <div class="sheet-item" style="width:10%"><button type='roll' value='!skill40k @{charname},@{dispforbiddenlorescores},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60},Forbidden Lore: @{dispforbiddenlorenames}, skill' name='roll_ForbiddenLoreCheck'></button></div>
                    </div>
                    </fieldset>
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:70%"><span>Inquiry (Fel)</span></div>
                        <div class="sheet-item" style="width:15%"><span name="attr_InquiryScore"></span></div>
                        <div class="sheet-item" style="width:10%"><button type='roll' value='!skill40k @{charname},@{InquiryScore},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60},Inquiry, skill' name='roll_InquiryCheck'></button></div>
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:70%"><span>Interrogation (WP)</span></div>
                        <div class="sheet-item" style="width:15%"><span name="attr_InterrogationScore"></span></div>
                        <div class="sheet-item" style="width:10%"><button type='roll' value='!skill40k @{charname},@{InterrogationScore},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60},Interrogation, skill' name='roll_InterrogationCheck'></button></div>
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:70%"><span>Intimidate (S)</span></div>
                        <div class="sheet-item" style="width:15%"><span name="attr_IntimidateScore"></span></div>
                        <div class="sheet-item" style="width:10%"><button type='roll' value='!skill40k @{charname},@{IntimidateScore},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60},Intimidate, skill' name='roll_IntimidateCheck'></button></div>
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:70%"><span>Linguistics (Int)</span></div>
                    </div>
                    <fieldset class="repeating_lndisps">
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:0%"><input name="attr_displinguisticsnames" type="text" value="" class='sheet-cell' style="display: none;"></div>
                        <div class="sheet-item" style="width:60%"><input name="attr_vdisplinguisticsnames" type="text" value="@{displinguisticsnames}" disabled="true" class='sheet-cell'></div>
                        <div class="sheet-item" style="width:14%"><input name="attr_vdisplinguisticsscores" type="number" value="@{displinguisticsscores}" disabled="true" class='sheet-cell'></div>
                        <div class="sheet-item" style="width:0%"><input name="attr_displinguisticsscores" type="number" value="" class='sheet-cell' style="display: none;"></div>
                        <div class="sheet-item" style="width:10%"><button type='roll' value='!skill40k @{charname},@{displinguisticsscores},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60},Linguistics: @{displinguisticsnames}, skill' name='roll_LinguisticsCheck'></button></div>
                    </div>
                    </fieldset>
                </div>
                <div class='sheet-col'>
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:70%"><span>Logic (Int)</span></div>
                        <div class="sheet-item" style="width:15%"><span name="attr_LogicScore"></span></div>
                        <div class="sheet-item" style="width:10%"><button type='roll' value='!skill40k @{charname},@{LogicScore},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60},Logic, skill' name='roll_LogicCheck'></button></div>
                    </div>  
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:70%"><span>Medicae (Int)</span></div>
                        <div class="sheet-item" style="width:15%"><span name="attr_MedicaeScore"></span></div>
                        <div class="sheet-item" style="width:10%"><button type='roll' value='!skill40k @{charname},@{MedicaeScore},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60},Medicae, skill' name='roll_MedicaeCheck'></button></div>
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:70%"><span>Navigate(Surface) (Int)</span></div>
                        <div class="sheet-item" style="width:15%"><span name="attr_NvSurfaceScore"></span></div>
                        <div class="sheet-item" style="width:10%"><button type='roll' value='!skill40k @{charname},@{NvSurfaceScore},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60},Navigate(Surface), skill' name='roll_NvSurfaceCheck'></button></div>
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:70%"><span>Navigate(Stellar) (Int)</span></div>
                        <div class="sheet-item" style="width:15%"><span name="attr_NvStellarScore"></span></div>
                        <div class="sheet-item" style="width:10%"><button type='roll' value='!skill40k @{charname},@{NvStellarScore},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60},Navigate(Stellar), skill' name='roll_NvStellarCheck'></button></div>
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:70%"><span>Navigate(Warp) (Int)</span></div>
                        <div class="sheet-item" style="width:15%"><span name="attr_NvWarpScore"></span></div>
                        <div class="sheet-item" style="width:10%"><button type='roll' value='!skill40k @{charname},@{NvWarpScore},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60},Navigate(Warp), skill' name='roll_NvWarpCheck'></button></div>
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:70%"><span>Operate(Aeronautica) (Int)</span></div>
                        <div class="sheet-item" style="width:15%"><span name="attr_OpAeronauticaScore"></span></div>
                        <div class="sheet-item" style="width:10%"><button type='roll' value='!skill40k @{charname},@{OpAeronauticaScore},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60},Operate(Aeronautica), skill' name='roll_OpAeronauticaCheck'></button></div>
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:70%"><span>Operate(Surface) (Int)</span></div>
                        <div class="sheet-item" style="width:15%"><span name="attr_OpSurfaceScore"></span></div>
                        <div class="sheet-item" style="width:10%"><button type='roll' value='!skill40k @{charname},@{OpSurfaceScore},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60},Operate(Surface), skill' name='roll_OpSurfaceCheck'></button></div>
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:70%"><span>Operate(Voidship) (Int)</span></div>
                       <div class="sheet-item" style="width:15%"><span name="attr_OpVoidshipScore"></span></div>
                        <div class="sheet-item" style="width:10%"><button type='roll' value='!skill40k @{charname},@{OpVoidshipScore},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60},Operate(Voidship), skill' name='roll_OpVoidshipCheck'></button></div>
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:70%"><span>Parry (WS)</span></div>
                        <div class="sheet-item" style="width:15%"><span name="attr_ParryScore"></span></div>
                        <div class="sheet-item" style="width:10%"><button type='roll' value='!skill40k @{charname},@{ParryScore},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60},Parry, skill' name='roll_ParryCheck'></button></div>
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:70%"><span>Psyniscience (Per)</span></div>
                        <div class="sheet-item" style="width:15%"><span name="attr_PsyniscienceScore"></span></div>
                        <div class="sheet-item" style="width:10%"><button type='roll' value='!skill40k @{charname},@{PsyniscienceScore},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60},Psyniscience, skill' name='roll_PsyniscienceCheck'></button></div>
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:70%"><span>Scholastic Lore (Int)</span></div>
                    </div>
                    <fieldset class="repeating_sldisps">
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:0%"><input name="attr_dispscholasticlorenames" type="text" value="" class='sheet-cell' style="display: none;"></div>
                        <div class="sheet-item" style="width:60%"><input name="attr_vdispscholasticlorenames" type="text" value="@{dispscholasticlorenames}" disabled="true" class='sheet-cell'></div>
                        <div class="sheet-item" style="width:14%"><input name="attr_vdispscholasticlorescores" type="number" value="@{dispscholasticlorescores}" disabled="true" class='sheet-cell'></div>
                        <div class="sheet-item" style="width:0%"><input name="attr_dispscholasticlorescores" type="number" value="" class='sheet-cell' style="display: none;"></div>
                        <div class="sheet-item" style="width:10%"><button type='roll' value='!skill40k @{charname},@{dispscholasticlorescores},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60},Scholastic Lore: @{dispscholasticlorenames}, skill' name='roll_ScholasticLoreCheck'></button></div>
                    </div>
                    </fieldset>
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:70%"><span>Scrutiny (Per)</span></div>
                        <div class="sheet-item" style="width:15%"><span name="attr_ScrutinyScore"></span></div>
                        <div class="sheet-item" style="width:10%"><button type='roll' value='!skill40k @{charname},@{ScrutinyScore},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60},Scrutiny, skill' name='roll_ScrutinyCheck'></button></div>
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:70%"><span>Security (Int)</span></div>
                        <div class="sheet-item" style="width:15%"><span name="attr_SecurityScore"></span></div>
                        <div class="sheet-item" style="width:10%"><button type='roll' value='!skill40k @{charname},@{SecurityScore},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60},Security, skill' name='roll_SecurityCheck'></button></div>
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:70%"><span>Sleight of Hand (Ag)</span></div>
                        <div class="sheet-item" style="width:15%"><span name="attr_SleightOfHandScore"></span></div>
                        <div class="sheet-item" style="width:10%"><button type='roll' value='!skill40k @{charname},@{SleightOfHandScore},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60},Sleight Of Hand, skill' name='roll_SleightOfHandCheck'></button></div>
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:70%"><span>Stealth (ag)</span></div>
                        <div class="sheet-item" style="width:15%"><span name="attr_StealthScore"></span></div>
                        <div class="sheet-item" style="width:10%"><button type='roll' value='!skill40k @{charname},@{StealthScore},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60},Stealth, skill' name='roll_StealthCheck'></button></div>
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:70%"><span>Survival (Per)</span></div>
                        <div class="sheet-item" style="width:15%"><span name="attr_SurvivalScore"></span></div>
                        <div class="sheet-item" style="width:10%"><button type='roll' value='!skill40k @{charname},@{SurvivalScore},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60},Survival, skill' name='roll_SurvivalCheck'></button></div>
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:70%"><span>Tech-Use (Int)</span></div>
                        <div class="sheet-item" style="width:15%"><span name="attr_TechUseScore"></span></div>
                        <div class="sheet-item" style="width:10%"><button type='roll' value='!skill40k @{charname},@{TechUseScore},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60},Tech-Use, skill' name='roll_TechUseCheck'></button></div>
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-item" style="width:70%"><span>Trade (Int)</span></div>
                        <div class="sheet-item" style="width:15%"><span name="attr_TradeScore"></span></div>
                        <div class="sheet-item" style="width:10%"><button type='roll' value='!skill40k @{charname},@{TradeScore},?{Check Difficulty|Challenging(+0), 0|Easy(+30), 30|Routine(+20), 20|Ordinary(+10), 10|Difficult(-10), -10|Hard(-20), -20|Very Hard(-30), -30|Arduous(-40), -40|Punishing(-50), -50|Hellish(-60), -60},Trade, skill' name='roll_TradeCheck'></button></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!--Third Row -->
    
    <div class="sheet-2colrow">
        <div class='sheet-col'>
            <div class="sheet-row">
                <div class="sheet-item" style="width:100%"><h4>Weapons</h4></div>
            </div>
            <input type="checkbox" name="attr_wpnpwrsel1" class="sheet-wpnpwrsel1" checked style="width: 100%">
            <input type="checkbox" name="attr_wpnpwrsel2" class="sheet-wpnpwrsel2" checked style="width: 100%">
            <span class="sheet-wpnsel1 sheet-bg">
                <div class="sheet-row sheet-header">
                    <input type="checkbox" name="attr_wpnselsf1" value="1" style="display:none;" class="wpnselsf">
                    <input type="checkbox" name="attr_wpnselsa1" value="1" style="display:none;" class="wpnselsa">
                    <input type="checkbox" name="attr_wpnselfa1" value="1" style="display:none;" class="wpnselfa">
                    <input type="checkbox" name="attr_wpnselmx1" value="1" style="display:none;" class="wpnselmx">
                    <input type="checkbox" name="attr_wpnselid1" value="1" style="display:none;" class="wpnselid">
                    <input type="checkbox" name="attr_wpnselme1" value="1" style="display:none;" class="wpnselme">
                    <input type="checkbox" name="attr_wpnselsw1" value="1" style="display:none;" class="wpnselsw">
                    <input type="checkbox" name="attr_wpnsella1" value="1" style="display:none;" class="wpnsella">
                    <input type="checkbox" name="attr_wpnselrg1" value="1" style="display:none;" class="wpnselrg">
                    <div class="sheet-item sheet-rangedrop1" style="width:20%">
                        <select name="attr_dispwpncurrng1" style="width:100%;">
                            <option value="0">Melee </option>
                            <option value="1">Point-Blank </option>
                            <option value="2">Short </option>
                            <option value="3">Normal </option>
                            <option value="4">Long </option>
                            <option value="5">Extreme </option>
                        </select>
                    </div>
                    <div class="sheet-item" style="width:0%"><input name="attr_dispwpnmxstr1" type="text" value="?{Fire Selection(Maximal)|Standard, 6|Semi-Auto, 7|Full-Auto, 8}" style="display: none;"></div>
                    <div class="sheet-item" style="width:0%"><input name="attr_dispwpnidstr1" type="text" value="?{Fire Selection(Indirect)|Standard, 3|Semi-Auto, 4|Full-Auto, 5}" style="display: none;"></div>
                    <div class="sheet-item sheet-sfroll1 sheet-sf" style="width:10%"><button type='roll' value='!ranged40k @{charname},@{BallisticSkill}, @{dispwpncurrng1}, 0, @{dispwpnsingleshot1}, @{dispwpnsemishot1}, @{dispwpnautoshot1}, @{dispwpndmgnumdice1}, @{dispwpndmgdice1}, @{dispwpndmgstatic1},  @{dispwpnpen1}, ?{Modifers (except Range & RoF)|0}, @{dispwpnspecialalt1}, @{dispwpnquality1}, @{talentstring}, @{dispwpnname1}, @{dispwpndmgtype1}' name='roll_StdRanged'></button></div>
                    <div class="sheet-item sheet-saroll1 sheet-sa" style="width:10%"><button type='roll' value='!ranged40k @{charname},@{BallisticSkill}, @{dispwpncurrng1}, 1, @{dispwpnsingleshot1}, @{dispwpnsemishot1}, @{dispwpnautoshot1}, @{dispwpndmgnumdice1}, @{dispwpndmgdice1}, @{dispwpndmgstatic1},  @{dispwpnpen1}, ?{Modifers (except Range & RoF)|0}, @{dispwpnspecialalt1}, @{dispwpnquality1}, @{talentstring}, @{dispwpnname1}, @{dispwpndmgtype1}' name='roll_SemiRanged'></button></div>
                    <div class="sheet-item sheet-faroll1 sheet-fa" style="width:10%"><button type='roll' value='!ranged40k @{charname},@{BallisticSkill}, @{dispwpncurrng1}, 2, @{dispwpnsingleshot1}, @{dispwpnsemishot1}, @{dispwpnautoshot1}, @{dispwpndmgnumdice1}, @{dispwpndmgdice1}, @{dispwpndmgstatic1},  @{dispwpnpen1}, ?{Modifers (except Range & RoF)|0}, @{dispwpnspecialalt1}, @{dispwpnquality1}, @{talentstring}, @{dispwpnname1}, @{dispwpndmgtype1}' name='roll_FullRanged'></button></div>
                    <div class="sheet-item sheet-idroll1 sheet-id" style="width:10%"><button type='roll' value='!ranged40k @{charname},@{BallisticSkill}, @{dispwpncurrng1}, @{dispwpnidstr1}, @{dispwpnsingleshot1}, @{dispwpnsemishot1}, @{dispwpnautoshot1}, @{dispwpndmgnumdice1}, @{dispwpndmgdice1}, @{dispwpndmgstatic1},  @{dispwpnpen1}, ?{Modifers (except Range & RoF)|0}, @{dispwpnspecialalt1}, @{dispwpnquality1}, @{talentstring}, @{dispwpnname1}, @{dispwpndmgtype1}' name='roll_IndirectRanged'></button></div>
                    <div class="sheet-item sheet-mxroll1 sheet-mx" style="width:10%"><button type='roll' value='!ranged40k @{charname},@{BallisticSkill}, @{dispwpncurrng1}, @{dispwpnmxstr1}, @{dispwpnsingleshot1}, @{dispwpnsemishot1}, @{dispwpnautoshot1}, @{dispwpndmgnumdice1}, @{dispwpndmgdice1}, @{dispwpndmgstatic1},  @{dispwpnpen1}, ?{Modifers (except Range & RoF)|0}, @{dispwpnspecialalt1}, @{dispwpnquality1}, @{talentstring}, @{dispwpnname1}, @{dispwpndmgtype1}' name='roll_MaximalRanged'></button></div>
                    <div class="sheet-item sheet-sfroll1 sheet-cs" style="width:10%"><button type='roll' value='!ranged40k @{charname},@{BallisticSkill}, @{dispwpncurrng1}, 9, @{dispwpnsingleshot1}, @{dispwpnsemishot1}, @{dispwpnautoshot1}, @{dispwpndmgnumdice1}, @{dispwpndmgdice1}, @{dispwpndmgstatic1},  @{dispwpnpen1}, ?{Modifers (except Range & RoF)|0}, @{dispwpnspecialalt1}, @{dispwpnquality1}, @{talentstring}, @{dispwpnname1}, @{dispwpndmgtype1}' name='roll_CalledRanged'></button></div>
                    <div class="sheet-item sheet-saroll1 sheet-su" style="width:10%"><button type='roll' value='!ranged40k @{charname},@{BallisticSkill}, @{dispwpncurrng1}, 10, @{dispwpnsingleshot1}, @{dispwpnsemishot1}, @{dispwpnautoshot1}, @{dispwpndmgnumdice1}, @{dispwpndmgdice1}, @{dispwpndmgstatic1},  @{dispwpnpen1}, ?{Modifers (except Range & RoF)|0}, @{dispwpnspecialalt1}, @{dispwpnquality1}, @{talentstring}, @{dispwpnname1}, @{dispwpndmgtype1}' name='roll_SemiSupRanged'></button></div>
                    <div class="sheet-item sheet-faroll1 sheet-su" style="width:10%"><button type='roll' value='!ranged40k @{charname},@{BallisticSkill}, @{dispwpncurrng1}, 11, @{dispwpnsingleshot1}, @{dispwpnsemishot1}, @{dispwpnautoshot1}, @{dispwpndmgnumdice1}, @{dispwpndmgdice1}, @{dispwpndmgstatic1},  @{dispwpnpen1}, ?{Modifers (except Range & RoF)|0}, @{dispwpnspecialalt1}, @{dispwpnquality1}, @{talentstring}, @{dispwpnname1}, @{dispwpndmgtype1}' name='roll_FullSupRanged'></button></div>
                    <div class="sheet-item sheet-stroll1 sheet-st" style="width:10%"><button type='roll' value='!melee40k @{charname},@{WeaponSkill}, 0, @{dispwpndmgnumdice1}, @{dispwpndmgdice1}, @{dispwpndmgstatic1},  @{dispwpnpen1},  @{StrengthMod}, ?{Modifers (except Quality/Attributes/Attack Mode)|0},  @{dispwpnspecialalt1}, @{dispwpnquality1}, @{talentstring}, @{dispwpnname1}, @{dispwpndmgtype1}, @{Psy}' name='roll_StdMelee'></button></div>
                    <div class="sheet-item sheet-swroll1 sheet-sw" style="width:10%"><button type='roll' value='!melee40k @{charname},@{WeaponSkill}, 1, @{dispwpndmgnumdice1}, @{dispwpndmgdice1}, @{dispwpndmgstatic1},  @{dispwpnpen1},  @{StrengthMod}, ?{Modifers (except Quality/Attributes/Attack Mode)|0},  @{dispwpnspecialalt1}, @{dispwpnquality1}, @{talentstring}, @{dispwpnname1}, @{dispwpndmgtype1}, @{Psy}' name='roll_StdMelee'></button></div>
                    <div class="sheet-item sheet-laroll1 sheet-la" style="width:10%"><button type='roll' value='!melee40k @{charname},@{WeaponSkill}, 2, @{dispwpndmgnumdice1}, @{dispwpndmgdice1}, @{dispwpndmgstatic1},  @{dispwpnpen1},  @{StrengthMod}, ?{Modifers (except Quality/Attributes/Attack Mode)|0},  @{dispwpnspecialalt1}, @{dispwpnquality1}, @{talentstring}, @{dispwpnname1}, @{dispwpndmgtype1}, @{Psy}' name='roll_StdMelee'></button></div>
                    <div class="sheet-item sheet-stroll1 sheet-ao" style="width:10%"><button type='roll' value='!melee40k @{charname},@{WeaponSkill}, 3, @{dispwpndmgnumdice1}, @{dispwpndmgdice1}, @{dispwpndmgstatic1},  @{dispwpnpen1},  @{StrengthMod}, ?{Modifers (except Quality/Attributes/Attack Mode)|0},  @{dispwpnspecialalt1}, @{dispwpnquality1}, @{talentstring}, @{dispwpnname1}, @{dispwpndmgtype1}, @{Psy}' name='roll_AllMelee'></button></div>
                    <div class="sheet-item sheet-stroll1 sheet-me" style="width:10%"><button type='roll' value='!melee40k @{charname},@{WeaponSkill}, ?{Select an Action|Charge, 5|Called Strike, 4|Feint, 6|Stun, 7|Disarm, 9}, @{dispwpndmgnumdice1}, @{dispwpndmgdice1}, @{dispwpndmgstatic1},  @{dispwpnpen1},  @{StrengthMod}, ?{Modifers (except Quality/Attributes/Attack Mode)|0},  @{dispwpnspecialalt1}, @{dispwpnquality1}, @{talentstring}, @{dispwpnname1}, @{dispwpndmgtype1}, @{Psy}' name='roll_CalMelee'></button></div>
                    <!--<div class="sheet-item sheet-stroll1" style="width:10%"><button type='roll' value='!melee40k @{charname},@{WeaponSkill}, 5, @{dispwpndmgnumdice1}, @{dispwpndmgdice1}, @{dispwpndmgstatic1},  @{dispwpnpen1},  @{StrengthMod}, ?{Modifers (except Quality/Attributes/Attack Mode)|0},  @{dispwpnspecialalt1}, @{dispwpnquality1}, @{talentstring}, @{dispwpnname1}, @{dispwpndmgtype1}, @{Psy}' name='roll_ChaMelee'></button></div>
                    <div class="sheet-item sheet-stroll1" style="width:10%"><button type='roll' value='!melee40k @{charname},@{WeaponSkill}, 6, @{dispwpndmgnumdice1}, @{dispwpndmgdice1}, @{dispwpndmgstatic1},  @{dispwpnpen1},  @{StrengthMod}, ?{Modifers (except Quality/Attributes/Attack Mode)|0},  @{dispwpnspecialalt1}, @{dispwpnquality1}, @{talentstring}, @{dispwpnname1}, @{dispwpndmgtype1}, @{Psy}' name='roll_FeiMelee'></button></div>
                    <div class="sheet-item sheet-stroll1" style="width:10%"><button type='roll' value='!melee40k @{charname},@{WeaponSkill}, 7, @{dispwpndmgnumdice1}, @{dispwpndmgdice1}, @{dispwpndmgstatic1},  @{dispwpnpen1},  @{StrengthMod}, ?{Modifers (except Quality/Attributes/Attack Mode)|0},  @{dispwpnspecialalt1}, @{dispwpnquality1}, @{talentstring}, @{dispwpnname1}, @{dispwpndmgtype1}, @{Psy}' name='roll_StuMelee'></button></div>
                   --> <div class="sheet-item sheet-stroll1 sheet-pr" style="width:10%"><button type='roll' value='!melee40k @{charname},@{ParryScore}, 8, @{dispwpndmgnumdice1}, @{dispwpndmgdice1}, @{dispwpndmgstatic1},  @{dispwpnpen1},  @{StrengthMod}, ?{Modifers (except Quality/Attributes/Attack Mode)|0},  @{dispwpnspecialalt1}, @{dispwpnquality1}, @{talentstring}, @{dispwpnname1}, @{dispwpndmgtype1}, @{Psy}' name='roll_ParMelee'></button></div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-item" style="width:34%"><span>Name</span></div>
                    <div class="sheet-item" style="width:23%"><span>Rate of Fire</span></div>
                    <div class="sheet-item" style="width:20%"><span>Range</span></div>
                    <div class="sheet-item" style="width:20%"><span>Reload</span></div>
                </div>
                <div class="sheet-row sheet-wpnsel1">
                    <div class="sheet-item" style="width:34%"><span name="attr_dispwpnname1"></span></div>
                    <div class="sheet-item" style="width:0%"><input name="attr_dispwpnname1" type="text" value="" style="display: none;"></div>
                    <div class="sheet-item" style="width:3%"><span  name="attr_dispwpnsingleshot1"></span></div>
                    <div class="sheet-item" style="width:0%"><input name="attr_dispwpnsingleshot1" type="text" value="" style="display: none;"></div>
                    <div class="sheet-item sheet-spindisable" style="width:2%"><span>/</span></div>
                    <div class="sheet-item" style="width:3%"><span  name="attr_dispwpnsemishot1"></span></div>
                    <div class="sheet-item" style="width:0%"><input name="attr_dispwpnsemishot1" type="number" value="" style="display: none;"></div>
                    <div class="sheet-item sheet-spindisable" style="width:2%"><span>/</span></div>
                    <div class="sheet-item" style="width:7%"><span name="attr_dispwpnautoshot1"></span></div>
                    <div class="sheet-item" style="width:0%"><input name="attr_dispwpnautoshot1" type="number" value="" style="display: none;"></div>
                    <div class="sheet-item" style="width:20%"><span name="attr_dispwpnrange1"></span></div>
                    <div class="sheet-item" style="width:0%"><input name="attr_dispwpnrange1" type="number" value="" style="display: none;"></div>
                    <div class="sheet-item" style="width:15%"><span name="attr_dispwpnrld1"></span></div>
                    <div class="sheet-item" style="width:0%">
                        <select name="attr_dispwpnrld1" style="display: none;">
                            <option value="half">Half</option>
                            <option value="full">Full</option>
                            <option value="2full">2 Full</option>
                            <option value="3full">3 Full</option>
                        </select>
                    </div>
                </div>
                <div class="sheet-row sheet-wpnsel1">
                    <div class="sheet-item" style="width:34%"><span>Damage</span></div>
                    <div class="sheet-item" style="width:23%"><span>Pen</span></div>
                    <div class="sheet-item" style="width:20%"><span>Clip</span></div>
                    <div class="sheet-item" style="width:20%"><span>Weight</span></div>
                </div>
                <div class="sheet-row sheet-wpnsel1">
                    <div class="sheet-item" style="width:3%"><span  name="attr_dispwpndmgnumdice1"></span></div>
                    <div class="sheet-item" style="width:0%"><input name="attr_dispwpndmgnumdice1" type="number" value="" style="display: none;"></div>
                    <div class="sheet-item sheet-spindisable" style="width:2%"><span>d</span></div>
                    <div class="sheet-item" style="width:3%"><span  name="attr_dispwpndmgdice1"></span></div>
                    <div class="sheet-item" style="width:0%"><input name="attr_dispwpndmgdice1" type="number" value="" style="display: none;"></div>
                    <div class="sheet-item sheet-spindisable" style="width:2%"><span>+</span></div>
                    <div class="sheet-item" style="width:3%"><span  name="attr_dispwpndmgstatic1"></span></div>
                    <div class="sheet-item" style="width:0%"><input name="attr_dispwpndmgstatic1" type="number" value="" style="display: none;"></div>
                    <div class="sheet-item" style="width:14%"><span name="attr_dispwpndmgtype1"></span></div>
                    <div class="sheet-item" style="width:0%">
                        <select style="display: none;" name="attr_dispwpndmgtype1">
                            <option value="impact">I</option>
                            <option value="rending">R</option>
                            <option value="energy">E</option>
                            <option value="explosive">X</option>
                        </select>
                    </div>
                    <div class="sheet-item" style="width:23%"><span name="attr_dispwpnpen1"></span></div>
                    <div class="sheet-item" style="width:0%"><input name="attr_dispwpnpen1" type="number" value="" style="display: none;"></div>
                    <div class="sheet-item" style="width:3%"><span  name="attr_dispwpnclipcur1"></span></div>
                    <div class="sheet-item" style="width:0%"><input name="attr_dispwpnclipcur1" type="number" value="" style="display: none;"></div>
                    <div class="sheet-item sheet-spindisable" style="width:2%"><span>/</span></div>
                    <div class="sheet-item" style="width:12%"><span name="attr_dispwpnclipmax1"></span></div>
                    <div class="sheet-item" style="width:0%"><input name="attr_dispwpnclipmax1" type="number" value="" style="display: none;"></div>
                    <div class="sheet-item" style="width:10%"><span name="attr_dispwpnweight1"></span></div>
                    <div class="sheet-item" style="width:0%; display:none;"><input name="attr_dispwpnweight1" type="number" value="" ></div>
                </div>
                <div class="sheet-row sheet-wpnsel1">
                    <div class="sheet-item" style="width:79%"><span>Special</span></div>
                    <div class="sheet-item" style="width:10%"><span>Quality</span></div>
                </div>
                <div class="sheet-row sheet-wpnsel1">                
                    <div class="sheet-item" style="width:79%"><span name="attr_dispwpnspecial1"></span></div>
                    <div class="sheet-item" style="width:0%"><input name="attr_dispwpnspecial1"     type="text" value="" style="display: none;"></div>
                    <div class="sheet-item" style="width:0%"><input name="attr_dispwpnspecialalt1"  type="text" value="" style="display: none;" ></div>
                    <div class="sheet-item" style="width:10%"><span name="attr_dispwpnquality1"></span></div>
                    <div class="sheet-item" style="width:0%">
                        <select style="display:none;" name="attr_dispwpnquality1">
                            <option value="poor">Poor</option>
                            <option value="common">Common</option>
                            <option value="good">Good</option>
                            <option value="best">Best</option>
                        </select>
                    </div>
                </div>
            </span>
            <span class="sheet-pwrsel1 sheet-bg">
            <div class="sheet-row sheet-pwrsel1">
                <div class="sheet-item sheet-psyroll" style="width:10%"><button type='roll' value='!psy40k @{charname},@{Willpower},?{Chosen PR|1}, ?{PR Modifiers|0}, @{Psy}, @{disppsyname1},@{disppsydmgflat1},@{disppsydmgstat1},@{disppsydmgpr1},@{disppsypen1},@{disppsypenpr1},@{disppsytype1},@{dispatktype1},@{disppsyfocus1},@{disppsyspecialalt1},@{disppsyeffect1},@{talentstring}' name='roll_Psychic'></button></div>
                <div class="sheet-item" style="width:22%"><span>Name</span></div>
                <div class="sheet-item" style="width:15%"><span>Action</span></div>
                <div class="sheet-item" style="width:15%"><span>Attack</span></div>
                <div class="sheet-item" style="width:20%"><span>Range(xPR)</span></div>
                <div class="sheet-item" style="width:10%"><span>Focus</span></div>
            </div>
            <div class="sheet-row sheet-pwrsel1">
                <div class="sheet-item sheet-spindisable" style="width:33%"><span name="attr_disppsyname1"></div>
                <div class="sheet-item sheet-spindisable" style="width:15%"><span name="attr_disppsyaction1"></span></div>
                <div class="sheet-item sheet-spindisable" style="width:15%"><span name="attr_dispatktype1"></span></div>
                <div class="sheet-item sheet-spindisable" style="width:20%"><span name="attr_disppsyrange1"></span></div>
                <div class="sheet-item sheet-spindisable" style="width:10%"><span name="attr_disppsyfocus1"></span></div>
            </div>
            <div class="sheet-row sheet-pwrsel1">
                <div class="sheet-item" style="width:15%"><span>Sustain</span></div>
                <div class="sheet-item" style="width:15%"><span>Subtype</span></div>
                <div class="sheet-item" style="width:32%"><span>Damage</span></div>
                <div class="sheet-item" style="width:21%"><span>Pen</span></div>
                <div class="sheet-item" style="width:10%"><span>Type</span></div>
            </div>
            <div class="sheet-row sheet-pwrsel1">
                <div class="sheet-item" style="width:15%"><span name="attr_disppsysustain1"></span></div>
                <div class="sheet-item" style="width:15%"><span name="attr_disppsysubtype1"></span></div>
                <div class="sheet-item" style="width:4%"><span name="attr_disppsydmgflat1"></span></div>
                <div class="sheet-item sheet-spindisable" style="width:8%"><span>d10+</span></div>
                <div class="sheet-item" style="width:4%"><span name="attr_disppsydmgstat1"></span></div>
                <div class="sheet-item sheet-spindisable" style="width:2%"><span>+</span></div>
                <div class="sheet-item" style="width:6%"><span name="attr_disppsydmgpr1"></span></div>
                <div class="sheet-item sheet-spindisable" style="width:10%"><span>xPR P</span></div>
                <div class="sheet-item" style="width:4%"><span name="attr_disppsypen1"></span></div>
                <div class="sheet-item sheet-spindisable" style="width:2%"><span>+</span></div>
                <div class="sheet-item" style="width:4%"><span name="attr_disppsypenpr1"></span></div>
                <div class="sheet-item sheet-spindisable" style="width:6%"><span>xPR</span></div>
                <div class="sheet-item" style="width:4%"><span name="attr_disppsytype1"></span></div>
                <div class="sheet-item" style="width:0%">
                        <select style="display:none;" name="attr_disppsytype1">
                            <option value="E">Energy</option>
                            <option value="R">Rending</option>
                            <option value="I">Impact</option>
                            <option value="X">Explosive</option>
                        </select>
                </div>
            </div>
            <div class="sheet-row sheet-pwrsel1">               
                <div class="sheet-item" style="width:100%"><span>Special</span></div>
            </div>
            <div class="sheet-row sheet-pwrsel1">                
                <div class="sheet-item" style="width:90%"><span name="attr_disppsyspecial1"></span></div>
                <div class="sheet-item" style="width:0%"><input name="attr_disppsyspecialalt1"  type="text" value="" style="display: none;" ></div>
            </div>
            <div class="sheet-row sheet-pwrsel1">               
                <div class="sheet-item" style="width:100%"><span>Effect</span></div>
            </div>
            <div class="sheet-row sheet-pwrsel1">                
                <div class="sheet-item" style="width:100%"><span name="attr_disppsyeffect1"></span></div>
            </div>
            </span>
            <span class="sheet-wpnsel2 sheet-bg">
                <div class="sheet-row sheet-header">
                    <input type="checkbox" name="attr_wpnselsf2" value="1" style="display:none;" class="wpnselsf">
                    <input type="checkbox" name="attr_wpnselsa2" value="1" style="display:none;" class="wpnselsa">
                    <input type="checkbox" name="attr_wpnselfa2" value="1" style="display:none;" class="wpnselfa">
                    <input type="checkbox" name="attr_wpnselmx2" value="1" style="display:none;" class="wpnselmx">
                    <input type="checkbox" name="attr_wpnselid2" value="1" style="display:none;" class="wpnselid">
                    <input type="checkbox" name="attr_wpnselme2" value="1" style="display:none;" class="wpnselme">
                    <input type="checkbox" name="attr_wpnselsw2" value="1" style="display:none;" class="wpnselsw">
                    <input type="checkbox" name="attr_wpnsella2" value="1" style="display:none;" class="wpnsella">
                    <input type="checkbox" name="attr_wpnselrg2" value="1" style="display:none;" class="wpnselrg">
                    <div class="sheet-item sheet-rangedrop2" style="width:20%">
                        <select name="attr_dispwpncurrng2" style="width:100%;">
                            <option value="0">Melee </option>
                            <option value="1">Point-Blank </option>
                            <option value="2">Short </option>
                            <option value="3">Normal </option>
                            <option value="4">Long </option>
                            <option value="5">Extreme </option>
                        </select>
                    </div>
                    <div class="sheet-item" style="width:0%"><input name="attr_dispwpnmxstr2" type="text" value="?{Fire Selection(Maximal)|Standard, 6|Semi-Auto, 7|Full-Auto, 8}" style="display: none;"></div>
                    <div class="sheet-item" style="width:0%"><input name="attr_dispwpnidstr2" type="text" value="?{Fire Selection(Indirect)|Standard, 3|Semi-Auto, 4|Full-Auto, 5}" style="display: none;"></div>
                    <div class="sheet-item sheet-sfroll2 sheet-sf" style="width:10%"><button type='roll' value='!ranged40k @{charname},@{BallisticSkill}, @{dispwpncurrng2}, 0, @{dispwpnsingleshot2}, @{dispwpnsemishot2}, @{dispwpnautoshot2}, @{dispwpndmgnumdice2}, @{dispwpndmgdice2}, @{dispwpndmgstatic2},  @{dispwpnpen2}, ?{Modifers (except Range & RoF)|0}, @{dispwpnspecialalt2}, @{dispwpnquality2}, @{talentstring}, @{dispwpnname2}, @{dispwpndmgtype2}' name='roll_StdAttack'></button></div>
                    <div class="sheet-item sheet-saroll2 sheet-sa" style="width:10%"><button type='roll' value='!ranged40k @{charname},@{BallisticSkill}, @{dispwpncurrng2}, 1, @{dispwpnsingleshot2}, @{dispwpnsemishot2}, @{dispwpnautoshot2}, @{dispwpndmgnumdice2}, @{dispwpndmgdice2}, @{dispwpndmgstatic2},  @{dispwpnpen2}, ?{Modifers (except Range & RoF)|0}, @{dispwpnspecialalt2}, @{dispwpnquality2}, @{talentstring}, @{dispwpnname2}, @{dispwpndmgtype2}' name='roll_SemiAttack'></button></div>
                    <div class="sheet-item sheet-faroll2 sheet-fa" style="width:10%"><button type='roll' value='!ranged40k @{charname},@{BallisticSkill}, @{dispwpncurrng2}, 2, @{dispwpnsingleshot2}, @{dispwpnsemishot2}, @{dispwpnautoshot2}, @{dispwpndmgnumdice2}, @{dispwpndmgdice2}, @{dispwpndmgstatic2},  @{dispwpnpen2}, ?{Modifers (except Range & RoF)|0}, @{dispwpnspecialalt2}, @{dispwpnquality2}, @{talentstring}, @{dispwpnname2}, @{dispwpndmgtype2}' name='roll_FullAttack'></button></div>
                    <div class="sheet-item sheet-idroll2 sheet-id" style="width:10%"><button type='roll' value='!ranged40k @{charname},@{BallisticSkill}, @{dispwpncurrng2}, @{dispwpnidstr2}, @{dispwpnsingleshot2}, @{dispwpnsemishot2}, @{dispwpnautoshot2}, @{dispwpndmgnumdice2}, @{dispwpndmgdice2}, @{dispwpndmgstatic2},  @{dispwpnpen2}, ?{Modifers (except Range & RoF)|0}, @{dispwpnspecialalt2}, @{dispwpnquality2}, @{talentstring}, @{dispwpnname2}, @{dispwpndmgtype2}' name='roll_IndirectAttack'></button></div>
                    <div class="sheet-item sheet-mxroll2 sheet-mx" style="width:10%"><button type='roll' value='!ranged40k @{charname},@{BallisticSkill}, @{dispwpncurrng2}, @{dispwpnmxstr2}, @{dispwpnsingleshot2}, @{dispwpnsemishot2}, @{dispwpnautoshot2}, @{dispwpndmgnumdice2}, @{dispwpndmgdice2}, @{dispwpndmgstatic2},  @{dispwpnpen2}, ?{Modifers (except Range & RoF)|0}, @{dispwpnspecialalt2}, @{dispwpnquality2}, @{talentstring}, @{dispwpnname2}, @{dispwpndmgtype2}' name='roll_MaximalAttack'></button></div>
                    <div class="sheet-item sheet-sfroll2 sheet-cs" style="width:10%"><button type='roll' value='!ranged40k @{charname},@{BallisticSkill}, @{dispwpncurrng2}, 9, @{dispwpnsingleshot2}, @{dispwpnsemishot2}, @{dispwpnautoshot2}, @{dispwpndmgnumdice2}, @{dispwpndmgdice2}, @{dispwpndmgstatic2},  @{dispwpnpen2}, ?{Modifers (except Range & RoF)|0}, @{dispwpnspecialalt2}, @{dispwpnquality2}, @{talentstring}, @{dispwpnname2}, @{dispwpndmgtype2}' name='roll_StdAttack'></button></div>
                    <div class="sheet-item sheet-saroll2 sheet-su" style="width:10%"><button type='roll' value='!ranged40k @{charname},@{BallisticSkill}, @{dispwpncurrng2}, 10, @{dispwpnsingleshot2}, @{dispwpnsemishot2}, @{dispwpnautoshot2}, @{dispwpndmgnumdice2}, @{dispwpndmgdice2}, @{dispwpndmgstatic2},  @{dispwpnpen2}, ?{Modifers (except Range & RoF)|0}, @{dispwpnspecialalt2}, @{dispwpnquality2}, @{talentstring}, @{dispwpnname2}, @{dispwpndmgtype2}' name='roll_StdAttack'></button></div>
                    <div class="sheet-item sheet-faroll2 sheet-su" style="width:10%"><button type='roll' value='!ranged40k @{charname},@{BallisticSkill}, @{dispwpncurrng2}, 11, @{dispwpnsingleshot2}, @{dispwpnsemishot2}, @{dispwpnautoshot2}, @{dispwpndmgnumdice2}, @{dispwpndmgdice2}, @{dispwpndmgstatic2},  @{dispwpnpen2}, ?{Modifers (except Range & RoF)|0}, @{dispwpnspecialalt2}, @{dispwpnquality2}, @{talentstring}, @{dispwpnname2}, @{dispwpndmgtype2}' name='roll_StdAttack'></button></div>
                    
                    <div class="sheet-item sheet-stroll2 sheet-st" style="width:10%"><button type='roll' value='!melee40k @{charname},@{WeaponSkill}, 0, @{dispwpndmgnumdice2}, @{dispwpndmgdice2}, @{dispwpndmgstatic2},  @{dispwpnpen2},  @{StrengthMod}, ?{Modifers (except Quality/Attributes/Attack Mode)|0},  @{dispwpnspecialalt2}, @{dispwpnquality2}, @{talentstring}, @{dispwpnname2}, @{dispwpndmgtype2}, @{Psy}' name='roll_StdMelee'></button></div>
                    <div class="sheet-item sheet-swroll2 sheet-sw" style="width:10%"><button type='roll' value='!melee40k @{charname},@{WeaponSkill}, 1, @{dispwpndmgnumdice2}, @{dispwpndmgdice2}, @{dispwpndmgstatic2},  @{dispwpnpen2},  @{StrengthMod}, ?{Modifers (except Quality/Attributes/Attack Mode)|0},  @{dispwpnspecialalt2}, @{dispwpnquality2}, @{talentstring}, @{dispwpnname2}, @{dispwpndmgtype2}, @{Psy}' name='roll_StdMelee'></button></div>
                    <div class="sheet-item sheet-laroll2 sheet-la" style="width:10%"><button type='roll' value='!melee40k @{charname},@{WeaponSkill}, 2, @{dispwpndmgnumdice2}, @{dispwpndmgdice2}, @{dispwpndmgstatic2},  @{dispwpnpen2},  @{StrengthMod}, ?{Modifers (except Quality/Attributes/Attack Mode)|0},  @{dispwpnspecialalt2}, @{dispwpnquality2}, @{talentstring}, @{dispwpnname2}, @{dispwpndmgtype2}, @{Psy}' name='roll_StdMelee'></button></div>
                    <div class="sheet-item sheet-stroll2 sheet-ao" style="width:10%"><button type='roll' value='!melee40k @{charname},@{WeaponSkill}, 3, @{dispwpndmgnumdice2}, @{dispwpndmgdice2}, @{dispwpndmgstatic2},  @{dispwpnpen2},  @{StrengthMod}, ?{Modifers (except Quality/Attributes/Attack Mode)|0},  @{dispwpnspecialalt2}, @{dispwpnquality2}, @{talentstring}, @{dispwpnname2}, @{dispwpndmgtype2}, @{Psy}' name='roll_AllMelee'></button></div>
                    <div class="sheet-item sheet-stroll2 sheet-me" style="width:10%"><button type='roll' value='!melee40k @{charname},@{WeaponSkill}, ?{Select an Action|Charge, 5|Called Strike, 4|Feint, 6|Stun, 7|Disarm, 9}, @{dispwpndmgnumdice2}, @{dispwpndmgdice2}, @{dispwpndmgstatic2},  @{dispwpnpen2},  @{StrengthMod}, ?{Modifers (except Quality/Attributes/Attack Mode)|0},  @{dispwpnspecialalt2}, @{dispwpnquality2}, @{talentstring}, @{dispwpnname2}, @{dispwpndmgtype2}, @{Psy}' name='roll_CalMelee'></button></div>
                    <!--<div class="sheet-item sheet-stroll2" style="width:10%"><button type='roll' value='!melee40k @{charname},@{WeaponSkill}, 5, @{dispwpndmgnumdice2}, @{dispwpndmgdice2}, @{dispwpndmgstatic2},  @{dispwpnpen2},  @{StrengthMod}, ?{Modifers (except Quality/Attributes/Attack Mode)|0},  @{dispwpnspecialalt2}, @{dispwpnquality2}, @{talentstring}, @{dispwpnname2}, @{dispwpndmgtype2}, @{Psy}' name='roll_ChaMelee'></button></div>
                    <div class="sheet-item sheet-stroll2" style="width:10%"><button type='roll' value='!melee40k @{charname},@{WeaponSkill}, 6, @{dispwpndmgnumdice2}, @{dispwpndmgdice2}, @{dispwpndmgstatic2},  @{dispwpnpen2},  @{StrengthMod}, ?{Modifers (except Quality/Attributes/Attack Mode)|0},  @{dispwpnspecialalt2}, @{dispwpnquality2}, @{talentstring}, @{dispwpnname2}, @{dispwpndmgtype2}, @{Psy}' name='roll_FeiMelee'></button></div>
                    <div class="sheet-item sheet-stroll2" style="width:10%"><button type='roll' value='!melee40k @{charname},@{WeaponSkill}, 7, @{dispwpndmgnumdice2}, @{dispwpndmgdice2}, @{dispwpndmgstatic2},  @{dispwpnpen2},  @{StrengthMod}, ?{Modifers (except Quality/Attributes/Attack Mode)|0},  @{dispwpnspecialalt2}, @{dispwpnquality2}, @{talentstring}, @{dispwpnname2}, @{dispwpndmgtype2}, @{Psy}' name='roll_StuMelee'></button></div>
                    --><div class="sheet-item sheet-stroll2 sheet-pr" style="width:10%"><button type='roll' value='!melee40k @{charname},@{ParryScore}, 8, @{dispwpndmgnumdice2}, @{dispwpndmgdice2}, @{dispwpndmgstatic2},  @{dispwpnpen2},  @{StrengthMod}, ?{Modifers (except Quality/Attributes/Attack Mode)|0},  @{dispwpnspecialalt2}, @{dispwpnquality2}, @{talentstring}, @{dispwpnname2}, @{dispwpndmgtype2}, @{Psy}' name='roll_ParMelee'></button></div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-item" style="width:34%"><span>Name</span></div>
                    <div class="sheet-item" style="width:23%"><span>Rate of Fire</span></div>
                    <div class="sheet-item" style="width:20%"><span>Range</span></div>
                    <div class="sheet-item" style="width:20%"><span>Reload</span></div>
                </div>
                <div class="sheet-row sheet-wpnsel1">
                    <div class="sheet-item" style="width:34%"><span name="attr_dispwpnname2"></span></div>
                    <div class="sheet-item" style="width:0%"><input name="attr_dispwpnname2" type="text" value="" style="display: none;"></div>
                    <div class="sheet-item" style="width:3%"><span  name="attr_dispwpnsingleshot2"></span></div>
                    <div class="sheet-item" style="width:0%"><input name="attr_dispwpnsingleshot2" type="number" value="" style="display: none;"></div>
                    <div class="sheet-item sheet-spindisable" style="width:2%"><span>/</span></div>
                    <div class="sheet-item" style="width:3%"><span  name="attr_dispwpnsemishot2"></span></div>
                    <div class="sheet-item" style="width:0%"><input name="attr_dispwpnsemishot2" type="number" value="" style="display: none;"></div>
                    <div class="sheet-item sheet-spindisable" style="width:2%"><span>/</span></div>
                    <div class="sheet-item" style="width:7%"><span name="attr_dispwpnautoshot2"></span></div>
                    <div class="sheet-item" style="width:0%"><input name="attr_dispwpnautoshot2" type="number" value="" style="display: none;"></div>
                    <div class="sheet-item" style="width:20%"><span name="attr_dispwpnrange2"></span></div>
                    <div class="sheet-item" style="width:0%"><input name="attr_dispwpnrange2" type="number" value="" style="display: none;"></div>
                    <div class="sheet-item" style="width:15%"><span name="attr_dispwpnrld2"></span></div>
                    <div class="sheet-item" style="width:0%">
                        <select name="attr_dispwpnrld2" style="display: none;">
                            <option value="half">Half</option>
                            <option value="full">Full</option>
                            <option value="2full">2 Full</option>
                            <option value="3full">3 Full</option>
                        </select>
                    </div>
                </div>
                <div class="sheet-row sheet-wpnsel2">
                    <div class="sheet-item" style="width:34%"><span>Damage</span></div>
                    <div class="sheet-item" style="width:23%"><span>Pen</span></div>
                    <div class="sheet-item" style="width:20%"><span>Clip</span></div>
                    <div class="sheet-item" style="width:20%"><span>Weight</span></div>
                </div>
                <div class="sheet-row sheet-wpnsel1">
                    <div class="sheet-item" style="width:3%"><span  name="attr_dispwpndmgnumdice2"></span></div>
                    <div class="sheet-item" style="width:0%"><input name="attr_dispwpndmgnumdice2" type="number" value="" style="display: none;"></div>
                    <div class="sheet-item sheet-spindisable" style="width:2%"><span>d</span></div>
                    <div class="sheet-item" style="width:3%"><span  name="attr_dispwpndmgdice2"></span></div>
                    <div class="sheet-item" style="width:0%"><input name="attr_dispwpndmgdice2" type="number" value="" style="display: none;"></div>
                    <div class="sheet-item sheet-spindisable" style="width:2%"><span>+</span></div>
                    <div class="sheet-item" style="width:3%"><span  name="attr_dispwpndmgstatic2"></span></div>
                    <div class="sheet-item" style="width:0%"><input name="attr_dispwpndmgstatic2" type="number" value="" style="display: none;"></div>
                    <div class="sheet-item" style="width:14%"><span name="attr_dispwpndmgtype2"></span></div>
                    <div class="sheet-item" style="width:0%">
                        <select style="display: none;" name="attr_dispwpndmgtype2">
                            <option value="impact">I</option>
                            <option value="rending">R</option>
                            <option value="energy">E</option>
                            <option value="explosive">X</option>
                        </select>
                    </div>
                    <div class="sheet-item" style="width:23%"><span name="attr_dispwpnpen2"></span></div>
                    <div class="sheet-item" style="width:0%"><input name="attr_dispwpnpen2" type="number" value="" style="display: none;"></div>
                    <div class="sheet-item" style="width:3%"><span  name="attr_dispwpnclipcur2"></span></div>
                    <div class="sheet-item" style="width:0%"><input name="attr_dispwpnclipcur2" type="number" value="" style="display: none;"></div>
                    <div class="sheet-item sheet-spindisable" style="width:2%"><span>/</span></div>
                    <div class="sheet-item" style="width:12%"><span name="attr_dispwpnclipmax2"></span></div>
                    <div class="sheet-item" style="width:0%"><input name="attr_dispwpnclipmax2" type="number" value="" style="display: none;"></div>
                    <div class="sheet-item" style="width:10%"><span name="attr_dispwpnweight2"></span></div>
                    <div class="sheet-item" style="width:0%"><input name="attr_dispwpnweight2" type="number" value="" style="display: none;"></div>
                </div>
                <div class="sheet-row sheet-wpnsel1">
                    <div class="sheet-item" style="width:79%"><span>Special</span></div>
                    <div class="sheet-item" style="width:10%"><span>Quality</span></div>
                </div>
                <div class="sheet-row sheet-wpnsel1">                
                    <div class="sheet-item" style="width:79%"><span name="attr_dispwpnspecial2"></span></div>
                    <div class="sheet-item" style="width:0%"><input name="attr_dispwpnspecial2" type="text"     value="" style="display: none;"></div>
                    <div class="sheet-item" style="width:0%"><input name="attr_dispwpnspecialalt2" type="text"  value="" style="display: none;"></div>
                    <div class="sheet-item" style="width:10%"><span name="attr_dispwpnquality2"></span></div>
                    <div class="sheet-item" style="width:0%">
                        <select style="display:none;" name="attr_dispwpnquality2">
                            <option value="poor">Poor</option>
                            <option value="common">Common</option>
                            <option value="good">Good</option>
                            <option value="best">Best</option>
                        </select>
                    </div>
                </div>
            </span>
            <span class="sheet-pwrsel2 sheet-bg">
            <div class="sheet-row sheet-pwrsel2">
                <div class="sheet-item sheet-psyroll" style="width:10%"><button type='roll' value='!psy40k @{charname},@{Willpower},?{Chosen PR|1}, ?{PR Modifiers|0}, @{Psy}, @{disppsyname2},@{disppsydmgflat2},@{disppsydmgstat2},@{disppsydmgpr2},@{disppsypen2},@{disppsypenpr2},@{disppsytype2},@{dispatktype2},@{disppsyfocus2},@{disppsyspecialalt2},@{disppsyeffect2},@{talentstring}' name='roll_Psychic'></button></div>
                <div class="sheet-item" style="width:22%"><span>Name</span></div>
                <div class="sheet-item" style="width:15%"><span>Action</span></div>
                <div class="sheet-item" style="width:15%"><span>Attack</span></div>
                <div class="sheet-item" style="width:20%"><span>Range(xPR)</span></div>
                <div class="sheet-item" style="width:10%"><span>Focus</span></div>
            </div>
            <div class="sheet-row sheet-pwrsel2">
                <div class="sheet-item sheet-spindisable" style="width:33%"><span name="attr_disppsyname2"></div>
                <div class="sheet-item sheet-spindisable" style="width:15%"><span name="attr_disppsyaction2"></span></div>
                <div class="sheet-item sheet-spindisable" style="width:15%"><span name="attr_dispatktype2"></span></div>
                <div class="sheet-item sheet-spindisable" style="width:20%"><span name="attr_disppsyrange2"></span></div>
                <div class="sheet-item sheet-spindisable" style="width:10%"><span name="attr_disppsyfocus2"></span></div>
            </div>
            <div class="sheet-row sheet-pwrsel2">
                <div class="sheet-item" style="width:15%"><span>Sustain</span></div>
                <div class="sheet-item" style="width:15%"><span>Subtype</span></div>
                <div class="sheet-item" style="width:32%"><span>Damage</span></div>
                <div class="sheet-item" style="width:21%"><span>Pen</span></div>
                <div class="sheet-item" style="width:10%"><span>Type</span></div>
            </div>
            <div class="sheet-row sheet-pwrsel2">
                <div class="sheet-item" style="width:15%"><span name="attr_disppsysustain2"></span></div>
                <div class="sheet-item" style="width:15%"><span name="attr_disppsysubtype2"></span></div>
                <div class="sheet-item" style="width:4%"><span name="attr_disppsydmgflat2"></span></div>
                <div class="sheet-item sheet-spindisable" style="width:8%"><span>d10+</span></div>
                <div class="sheet-item" style="width:4%"><span name="attr_disppsydmgstat2"></span></div>
                <div class="sheet-item sheet-spindisable" style="width:2%"><span>+</span></div>
                <div class="sheet-item" style="width:6%"><span name="attr_disppsydmgpr2"></span></div>
                <div class="sheet-item sheet-spindisable" style="width:10%"><span>xPR P</span></div>
                <div class="sheet-item" style="width:4%"><span name="attr_disppsypen2"></span></div>
                <div class="sheet-item sheet-spindisable" style="width:2%"><span>+</span></div>
                <div class="sheet-item" style="width:4%"><span name="attr_disppsypenpr2"></span></div>
                <div class="sheet-item sheet-spindisable" style="width:6%"><span>xPR</span></div>
                <div class="sheet-item" style="width:4%"><span name="attr_disppsytype2"></span></div>
                <div class="sheet-item" style="width:0%">
                        <select style="display:none;" name="attr_disppsytype2">
                            <option value="E">Energy</option>
                            <option value="R">Rending</option>
                            <option value="I">Impact</option>
                            <option value="X">Explosive</option>
                        </select>
                </div>
            </div>
            <div class="sheet-row sheet-pwrsel2">               
                <div class="sheet-item" style="width:100%"><span>Special</span></div>
            </div>
            <div class="sheet-row sheet-pwrsel2">                
                <div class="sheet-item" style="width:90%"><span name="attr_disppsyspecial2"></span></div>
                <div class="sheet-item" style="width:0%"><input name="attr_disppsyspecialalt2"  type="text" value="" style="display: none;" ></div>
            </div>
            <div class="sheet-row sheet-pwrsel2">               
                <div class="sheet-item" style="width:100%"><span>Effect</span></div>
            </div>
            <div class="sheet-row sheet-pwrsel2">                
                <div class="sheet-item" style="width:100%"><span name="attr_disppsyeffect2"></span></div>
            </div>
            </span>
        </div>
        <div class='sheet-col sheet-playerfill'>
            <div class="sheet-row">
                <div class="sheet-item" style="width:100%"><h4>Equipment</h4></div>
            </div>
            <div class="sheet-row">
                <div class="sheet-item" style="width:30%"><span>Name</span></div>
                <div class="sheet-item" style="width:60%"><span>Description</span></div>
            </div>
            <div class="sheet-row">
                <div class="sheet-item" style="width:30%"><input name="attr_dispequipname1" type="text" value="" style="width:100%"></div>
                <div class="sheet-item" style="width:60%"><input name="attr_dispequipdesc1" type="text" value="" style="width:100%"></div>
            </div>
            <div class="sheet-row">
                <div class="sheet-item" style="width:30%"><input name="attr_dispequipname2" type="text" value="" style="width:100%"></div>
                <div class="sheet-item" style="width:60%"><input name="attr_dispequipdesc2" type="text" value="" style="width:100%"></div>
            </div>
            <div class="sheet-row">
                <div class="sheet-item" style="width:30%"><input name="attr_dispequipname3" type="text" value="" style="width:100%"></div>
                <div class="sheet-item" style="width:60%"><input name="attr_dispequipdesc3" type="text" value="" style="width:100%"></div>
            </div>
            <div class="sheet-row">
                <div class="sheet-item" style="width:30%"><input name="attr_dispequipname4" type="text" value="" style="width:100%"></div>
                <div class="sheet-item" style="width:60%"><input name="attr_dispequipdesc4" type="text" value="" style="width:100%"></div>
            </div>
            <div class="sheet-row">
                <div class="sheet-item" style="width:30%"><input name="attr_dispequipname5" type="text" value="" style="width:100%"></div>
                <div class="sheet-item" style="width:60%"><input name="attr_dispequipdesc5" type="text" value="" style="width:100%"></div>
            </div>
            <div class="sheet-row">
                <div class="sheet-item" style="width:30%"><input name="attr_dispequipname6" type="text" value="" style="width:100%"></div>
                <div class="sheet-item" style="width:60%"><input name="attr_dispequipdesc6" type="text" value="" style="width:100%"></div>
            </div>
            <div class="sheet-row">
                <div class="sheet-item" style="width:30%"><input name="attr_dispequipname7" type="text" value="" style="width:100%"></div>
                <div class="sheet-item" style="width:60%"><input name="attr_dispequipdesc7" type="text" value="" style="width:100%"></div>
            </div>
            <div class="sheet-row">
                <div class="sheet-item" style="width:30%"><input name="attr_dispequipname8" type="text" value="" style="width:100%"></div>
                <div class="sheet-item" style="width:60%"><input name="attr_dispequipdesc8" type="text" value="" style="width:100%"></div>
            </div>
            <div class="sheet-row">
                <div class="sheet-item" style="width:30%"><input name="attr_dispequipname9" type="text" value="" style="width:100%"></div>
                <div class="sheet-item" style="width:60%"><input name="attr_dispequipdesc9" type="text" value="" style="width:100%"></div>
            </div>
            <div class="sheet-row">
                <div class="sheet-item" style="width:30%"><input name="attr_dispequipname10" type="text" value="" style="width:100%"></div>
                <div class="sheet-item" style="width:60%"><input name="attr_dispequipdesc10" type="text" value="" style="width:100%"></div>
            </div>
        </div>
    </div>
</div>
            
            




<!--Input Sheet -->


<div class="sheet-inputwrapper">
    <div class='sheet-3colrow'>
        <div class='sheet-col sheet-bg sheet-skills'>
                <div class='sheet-row'>
                    <div class="sheet-item" style="width:30%">Stat</div>
                    <div class="sheet-item" style="width:15%">Score</div>
                    <div class="sheet-item" style="width:15%">Ranks</div>
                    <div class="sheet-item" style="width:15%">Adj</div>
                    <div class="sheet-item" style="width:15%">Unnatural</div>
                </div>    
                <div class='sheet-row'>
                    <div class="sheet-item" style="width:30%"><span>Weapon Skill</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_WeaponSkill" type="number" value="0"class='sheet-cell'></div> 
                    <div class="sheet-item" style="width:15%"><input name="attr_WeaponSkillUpgrades" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_WeaponSkillAdj" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_WeaponSkillUnnat" type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class='sheet-row'>
                    <div class="sheet-item" style="width:30%"><span>Ballistic Skill</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_BallisticSkill" type="number" value="0"class='sheet-cell'></div> 
                    <div class="sheet-item" style="width:15%"><input name="attr_BallisticSkillUpgrades" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_BallisticSkillAdj" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_BallisticSkillUnnat" type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class='sheet-row'>
                    <div class="sheet-item" style="width:30%"><span>Strength</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_Strength" type="number" value="0" class='sheet-cell'></div> 
                    <div class="sheet-item" style="width:15%"><input name="attr_StrengthUpgrades" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_StrengthAdj" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_StrengthUnnat" type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class='sheet-row'>
                    <div class="sheet-item" style="width:30%"><span>Toughness</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_Toughness" type="number" value="0" class='sheet-cell'></div> 
                    <div class="sheet-item" style="width:15%"><input name="attr_ToughnessUpgrades" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_ToughnessAdj" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_ToughnessUnnat" type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class='sheet-row'>
                    <div class="sheet-item" style="width:30%"><span>Agility</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_Agility" type="number" value="0" class='sheet-cell'></div> 
                    <div class="sheet-item" style="width:15%"><input name="attr_AgilityUpgrades" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_AgilityAdj" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_AgilityUnnat" type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class='sheet-row'>
                    <div class="sheet-item" style="width:30%"><span>Intelligence</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_Intelligence" type="number" value="0" class='sheet-cell'></div> 
                    <div class="sheet-item" style="width:15%"><input name="attr_IntelligenceUpgrades" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_IntelligenceAdj" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_IntelligenceUnnat" type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class='sheet-row'>
                    <div class="sheet-item" style="width:30%"><span>Perception</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_Perception" type="number" value="0" class='sheet-cell'></div> 
                    <div class="sheet-item" style="width:15%"><input name="attr_PerceptionUpgrades" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_PerceptionAdj" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_PerceptionUnnat" type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class='sheet-row'>
                    <div class="sheet-item" style="width:30%"><span>Willpower</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_Willpower" type="number" value="0" class='sheet-cell'></div> 
                    <div class="sheet-item" style="width:15%"><input name="attr_WillpowerUpgrades" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_WillpowerAdj" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_WillpowerUnnat" type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class='sheet-row'>
                    <div class="sheet-item" style="width:30%"><span>Fellowship</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_Fellowship" type="number" value="0" class='sheet-cell'></div> 
                    <div class="sheet-item" style="width:15%"><input name="attr_FellowshipUpgrades" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_FellowshipAdj" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_FellowshipUnnat" type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class='sheet-row'>
                    <div class="sheet-item" style="width:30%"><span>Influence</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_Influence" type="number" value="0" class='sheet-cell'></div> 
                    <div class="sheet-item" style="width:15%"><input name="attr_InfluenceUpgrades" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_InfluenceAdj" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_InfluenceUnnat" type="number" value="0" class='sheet-cell'></div>
                </div> 
                <div class='sheet-row'>
                    <div class="sheet-item" style="width:30%">Type</div>
                    <div class="sheet-item" style="width:15%">Current</div>
                    <div class="sheet-item" style="width:15%">Maximum</div>
                </div>    
                <div class='sheet-row'>
                    <div class="sheet-item" style="width:30%"><span>Fate Points</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_CurFatePoints" type="number" value="0" class='sheet-cell'></div> 
                    <div class="sheet-item" style="width:15%"><input name="attr_MaxFatePoints" type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class='sheet-row'>
                    <div class="sheet-item" style="width:30%"><span>Wounds</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_CurWounds" type="number" value="0" class='sheet-cell'></div> 
                    <div class="sheet-item" style="width:15%"><input name="attr_MaxWounds" type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class='sheet-row'>
                    <div class="sheet-item" style="width:30%"><span>Carrying Capacity</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_CurCapacity" type="number" value="0" class='sheet-cell sheet-spindisable' readonly></div> 
                    <div class="sheet-item" style="width:15%"><input name="attr_MaxCapacity" type="number" value="0" class='sheet-cell sheet-spindisable' readonly></div>
                </div>
                <div class='sheet-row'>
                    <div class="sheet-item" style="width:30%"><span>Fatigue</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_CurFatigue" type="number" value="0" class='sheet-cell'></div> 
                    <div class="sheet-item" style="width:15%"><input name="attr_MaxFatigue" type="number" value="(@{WillpowerMod}+@{ToughnessMod})" class='sheet-cell' disabled="true"></div>
                </div>
                <div class='sheet-row'>
                    <div class="sheet-item" style="width:30%"><span>Psy Rating</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_Psy" type="number" value="0" class='sheet-cell'></div> 
                    <div class="sheet-item" style="width:15%"><input name="attr_MaxPsy" type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class='sheet-row'>
                    <div class="sheet-item" style="width:30%"><span>Insanity</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_Insanity" type="number" value="0" class='sheet-cell'></div> 
                    <div class="sheet-item" style="width:15%"><input name="attr_MaxInsanity" type="number" value="100" class='sheet-cell sheet-spindisable'></div>
                </div>
                <div class='sheet-row'>
                    <div class="sheet-item" style="width:30%"><span>Corruption</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_Corruption" type="number" value="0" class='sheet-cell'></div> 
                    <div class="sheet-item" style="width:15%"><input name="attr_MaxCorruption" type="number" value="100" class='sheet-cell sheet-spindisable'></div>
                </div>
                <div class='sheet-row'>
                    <div class="sheet-item" style="width:15%">Armor</div>
                </div>
                <div class='sheet-row'>
                    <div class="sheet-item" style="width:30%">Armor Value</div>
                    <div class="sheet-item" style="width:15%">Toughness</div>
                </div>
                <div class='sheet-row'>
                    <div class="sheet-item" style="width:30%"><span>Head</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_headArmor" type="number" value="0" class='sheet-cell'></div> 
                    <div class="sheet-item" style="width:15%"><input name="attr_headToughness" type="number" value="(@{ToughnessMod})" class='sheet-cell' disabled="true"></div>
                </div>
                <div class='sheet-row'>
                    <div class="sheet-item" style="width:30%"><span>Body</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_bodyArmor" type="number" value="0" class='sheet-cell'></div> 
                    <div class="sheet-item" style="width:15%"><input name="attr_bodyToughness" type="number" value="(@{ToughnessMod})" class='sheet-cell' disabled="true"></div>
                </div>
                <div class='sheet-row'>
                    <div class="sheet-item" style="width:30%"><span>Left Arm</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_leftArmArmor" type="number" value="0" class='sheet-cell'></div> 
                    <div class="sheet-item" style="width:15%"><input name="attr_leftArmToughness" type="number" value="(@{ToughnessMod})" class='sheet-cell' disabled="true"></div>
                </div>
                <div class='sheet-row'>
                    <div class="sheet-item" style="width:30%"><span>Right Arm</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_rightArmArmor" type="number" value="0" class='sheet-cell'></div> 
                    <div class="sheet-item" style="width:15%"><input name="attr_rightArmToughness" type="number" value="(@{ToughnessMod})" class='sheet-cell' disabled="true"></div>
                </div>
                <div class='sheet-row'>
                    <div class="sheet-item" style="width:30%"><span>Left Arm</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_leftLegArmor" type="number" value="0" class='sheet-cell'></div> 
                    <div class="sheet-item" style="width:15%"><input name="attr_leftLegToughness" type="number" value="(@{ToughnessMod})" class='sheet-cell' disabled="true"></div>
                </div>
                <div class='sheet-row'>
                    <div class="sheet-item" style="width:30%"><span>Right Arm</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_rightLegArmor" type="number" value="0" class='sheet-cell'></div> 
                    <div class="sheet-item" style="width:15%"><input name="attr_rightLegToughness" type="number" value="(@{ToughnessMod})" class='sheet-cell' disabled="true"></div>
                </div>
                <div class='sheet-row'>
                    <div class="sheet-item" style="width:30%"><span>Shield</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_shieldvalue" type="number" value="0" class='sheet-cell'></div> 
                    <div class="sheet-item" style="width:15%"><input name="attr_shieldoverload" type="number" value="0" class='sheet-cell'></div>
                </div>
        </div>
        <div class='sheet-col sheet-bg sheet-skills'>
            <!-- Second column--> 
                <div class="sheet-row">
                    <div class="sheet-item" style="width:30%">Name</div>
                    <div class="sheet-item" style="width:18%">Stat</div>
                    <div class="sheet-item" style="width:15%">Score</div>
                    <div class="sheet-item" style="width:15%">Ranks</div>
                    <div class="sheet-item" style="width:15%">Misc</div>
                </div>
                 <div class="sheet-row">
                    <div class="sheet-item" style="width:30%"><span>Acrobatics</span></div>
                    <div class="sheet-item" style="width:18%"><span>Agility</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_AcrobaticsScore" type="number" value="0" class='sheet-cell sheet-spindisable' readonly></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_AcrobaticsRanks" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_AcrobaticsMisc"  type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-item" style="width:30%"><span>Athletics</span></div>
                    <div class="sheet-item" style="width:18%"><span>Strength</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_AthleticsScore" type="number" value="0" class='sheet-cell sheet-spindisable' readonly></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_AthleticsRanks" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_AthleticsMisc"  type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-item" style="width:30%"><span>Awareness</span></div>
                    <div class="sheet-item" style="width:18%"><span>Perception</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_AwarenessScore" type="number" value="0" class='sheet-cell sheet-spindisable' readonly></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_AwarenessRanks" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_AwarenessMisc"  type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-item" style="width:30%"><span>Charm</span></div>
                    <div class="sheet-item" style="width:18%"><span>Fellowship</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_CharmScore" type="number" value="0" class='sheet-cell sheet-spindisable' readonly></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_CharmRanks" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_CharmMisc"  type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-item" style="width:30%"><span>Command</span></div>
                    <div class="sheet-item" style="width:18%"><span>Fellowship</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_CommandScore" type="number" value="0" class='sheet-cell sheet-spindisable' readonly></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_CommandRanks" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_CommandMisc"  type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-item" style="width:30%"><span>Commerce</span></div>
                    <div class="sheet-item" style="width:18%"><span>Fellowship</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_CommerceScore" type="number" value="0" class='sheet-cell sheet-spindisable' readonly></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_CommerceRanks" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_CommerceMisc"  type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-item" style="width:30%"><span>Deceive</span></div>
                    <div class="sheet-item" style="width:18%"><span>Fellowship</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_DeceiveScore" type="number" value="0" class='sheet-cell sheet-spindisable' readonly></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_DeceiveRanks" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_DeceiveMisc"  type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-item" style="width:30%"><span>Dodge</span></div>
                    <div class="sheet-item" style="width:18%"><span>Agility</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_DodgeScore" type="number" value="0" class='sheet-cell sheet-spindisable' readonly></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_DodgeRanks" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_DodgeMisc"  type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-item" style="width:30%"><span>Inquiry</span></div>
                    <div class="sheet-item" style="width:18%"><span>Fellowship</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_InquiryScore" type="number" value="0" class='sheet-cell sheet-spindisable' readonly></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_InquiryRanks" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_InquiryMisc"  type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-item" style="width:30%"><span>Interrogation</span></div>
                    <div class="sheet-item" style="width:18%"><span>Willpower</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_InterrogationScore" type="number" value="0" class='sheet-cell sheet-spindisable' readonly></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_InterrogationRanks" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_InterrogationMisc"  type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-item" style="width:30%"><span>Intimidate</span></div>
                    <div class="sheet-item" style="width:18%"><span>Strength</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_IntimidateScore" type="number" value="0" class='sheet-cell sheet-spindisable' readonly></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_IntimidateRanks" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_IntimidateMisc"  type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-item" style="width:30%"><span>Logic</span></div>
                    <div class="sheet-item" style="width:18%"><span>Intelligence</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_LogicScore" type="number" value="0" class='sheet-cell sheet-spindisable'readonly ></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_LogicRanks" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_LogicMisc"  type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-item" style="width:30%"><span>Medicae</span></div>
                    <div class="sheet-item" style="width:18%"><span>Intelligence</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_MedicaeScore" type="number" value="0" class='sheet-cell sheet-spindisable'readonly ></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_MedicaeRanks" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_MedicaeMisc"  type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-item" style="width:30%"><span>Navigate(Surface)</span></div>
                    <div class="sheet-item" style="width:18%"><span>Intelligence</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_NvSurfaceScore" type="number" value="0" class='sheet-cell sheet-spindisable' readonly></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_NvSurfaceRanks" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_NvSurfaceMisc"  type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-item" style="width:30%"><span>Navigate(Stellar)</span></div>
                    <div class="sheet-item" style="width:18%"><span>Intelligence</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_NvStellarScore" type="number" value="0" class='sheet-cell sheet-spindisable' readonly></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_NvStellarRanks" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_NvStellarMisc"  type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-item" style="width:30%"><span>Navigate(Warp)</span></div>
                    <div class="sheet-item" style="width:18%"><span>Intelligence</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_NvWarpScore" type="number" value="0" class='sheet-cell sheet-spindisable' readonly></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_NvWarpRanks" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_NvWarpMisc"  type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-item" style="width:30%"><span>Operate(Aero)</span></div>
                    <div class="sheet-item" style="width:18%"><span>Agility</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_OpAeronauticaScore" type="number" value="0" class='sheet-cell sheet-spindisable' readonly></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_OpAeronauticaRanks" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_OpAeronauticaMisc"  type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-item" style="width:30%"><span>Operate(Surface)</span></div>
                    <div class="sheet-item" style="width:18%"><span>Agility</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_OpSurfaceScore" type="number" value="0" class='sheet-cell sheet-spindisable' readonly></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_OpSurfaceRanks" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_OpSurfaceMisc"  type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-item" style="width:30%"><span>Operate(Voidship)</span></div>
                    <div class="sheet-item" style="width:18%"><span>Agility</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_OpVoidshipScore" type="number" value="0" class='sheet-cell sheet-spindisable' readonly></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_OpVoidshipRanks" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_OpVoidshipMisc" type="number"  value="0" class='sheet-cell'></div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-item" style="width:30%"><span>Parry</span></div>
                    <div class="sheet-item" style="width:18%"><span>Wpn Skill</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_ParryScore" type="number" value="0" class='sheet-cell sheet-spindisable' readonly></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_ParryRanks" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_ParryMisc" type="number"  value="0" class='sheet-cell'></div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-item" style="width:30%"><span>Psyniscience</span></div>
                    <div class="sheet-item" style="width:18%"><span>Willpower</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_PsyniscienceScore" type="number" value="0" class='sheet-cell sheet-spindisable' readonly></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_PsyniscienceRanks" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_PsyniscienceMisc"  type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-item" style="width:30%"><span>Scrutiny</span></div>
                    <div class="sheet-item" style="width:18%"><span>Perception</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_ScrutinyScore" type="number" value="0" class='sheet-cell sheet-spindisable' readonly></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_ScrutinyRanks" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_ScrutinyMisc"  type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-item" style="width:30%"><span>Security</span></div>
                    <div class="sheet-item" style="width:18%"><span>Intelligence</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_SecurityScore" type="number" value="0" class='sheet-cell sheet-spindisable' readonly></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_SecurityRanks" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_SecurityMisc"  type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-item" style="width:30%"><span>SleightOfHand</span></div>
                    <div class="sheet-item" style="width:18%"><span>Agility</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_SleightOfHandScore" type="number" value="0" class='sheet-cell sheet-spindisable' readonly></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_SleightOfHandRanks" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_SleightOfHandMisc"  type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-item" style="width:30%"><span>Stealth</span></div>
                    <div class="sheet-item" style="width:18%"><span>Agility</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_StealthScore" type="number" value="0" class='sheet-cell sheet-spindisable' readonly></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_StealthRanks" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_StealthMisc"  type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-item" style="width:30%"><span>Survival</span></div>
                    <div class="sheet-item" style="width:18%"><span>Perception</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_SurvivalScore" type="number" value="0" class='sheet-cell sheet-spindisable' readonly></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_SurvivalRanks" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_SurvivalMisc"  type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-item" style="width:30%"><span>TechUse</span></div>
                    <div class="sheet-item" style="width:18%"><span>Intelligence</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_TechUseScore" type="number" value="0" class='sheet-cell sheet-spindisable' readonly></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_TechUseRanks" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_TechUseMisc"  type="number" value="0" class='sheet-cell'></div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-item" style="width:30%"><span>Trade:</span><input name="attr_TradeName" type="text" value="N/A" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:18%"><span>Intelligence</span></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_TradeScore" type="number" value="0" class='sheet-cell sheet-spindisable' readonly></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_TradeRanks" type="number" value="0" class='sheet-cell'></div>
                    <div class="sheet-item" style="width:15%"><input name="attr_TradeMisc"  type="number" value="0" class='sheet-cell'></div>
                </div>
        </div>
        <div class='sheet-col sheet-bg sheet-skills'>
            <!-- Third column -->
            <div class="sheet-row">
                <div class="sheet-item" style="width:30%"><span>Name</span></div>
                <div class="sheet-item" style="width:18%"><span>Stat</span></div>
                <div class="sheet-item" style="width:15%"><span>Score</span></div>
                <div class="sheet-item" style="width:15%"><span>Rank</span></div>
                <div class="sheet-item" style="width:15%"><span>Misc</span></div>             
            </div>
            <div class="sheet-row">
                <div class="sheet-item" style="width:92%"><span>Common Lore</span></div>           
            </div> 
            <fieldset class="repeating_cls">
            <div class="sheet-row">
                <div class="sheet-item" style="width:30%"><input name="attr_CommonLoreNames" type="text" value="N/A" class='sheet-cell'></div>
                <div class="sheet-item" style="width:18%"><span>Intelligence</span></div>
                <div class="sheet-item" style="width:15%"><input name="attr_CommonLoreScores" type="number" value="0" class='sheet-cell sheet-spindisable' readonly></div>
                <div class="sheet-item" style="width:15%"><input name="attr_CommonLoreRanks" type="number" value="0" class='sheet-cell'></div>
                <div class="sheet-item" style="width:15%"><input name="attr_CommonLoreMiscs"  type="number" value="0" class='sheet-cell'></div>
            </div>
            </fieldset>
            <div class="sheet-row">
                <div class="sheet-item" style="width:92%"><span>Scholastic Lore</span></div>    
            </div>
            <fieldset class="repeating_sls">
            <div class="sheet-row">
                <div class="sheet-item" style="width:30%"><input name="attr_ScholasticLoreNames" type="text" value="N/A" class='sheet-cell'></div>
                <div class="sheet-item" style="width:18%"><span>Intelligence</span></div>
                <div class="sheet-item" style="width:15%"><input name="attr_ScholasticLoreScores" type="number" value="0" class='sheet-cell sheet-spindisable' readonly></div>
                <div class="sheet-item" style="width:15%"><input name="attr_ScholasticLoreRanks" type="number" value="0" class='sheet-cell'></div>
                <div class="sheet-item" style="width:15%"><input name="attr_ScholasticLoreMiscs"  type="number" value="0" class='sheet-cell'></div>
            </div>
            </fieldset>
            <div class="sheet-row">
                <div class="sheet-item" style="width:92%"><span>Forbidden Lore</span></div>    
            </div>
            <fieldset class="repeating_fls">
            <div class="sheet-row">
                <div class="sheet-item" style="width:30%"><input name="attr_ForbiddenLoreNames" type="text" value="N/A" class='sheet-cell'></div>
                <div class="sheet-item" style="width:18%"><span>Intelligence</span></div>
                <div class="sheet-item" style="width:15%"><input name="attr_ForbiddenLoreScores" type="number" value="0" class='sheet-cell sheet-spindisable' readonly></div>
                <div class="sheet-item" style="width:15%"><input name="attr_ForbiddenLoreRanks" type="number" value="0" class='sheet-cell'></div>
                <div class="sheet-item" style="width:15%"><input name="attr_ForbiddenLoreMiscs"  type="number" value="0" class='sheet-cell'></div>
            </div>
            </fieldset>
            <div class="sheet-row">
                <div class="sheet-item" style="width:92%"><span>Linguistics</span></div>    
            </div>
            <fieldset class="repeating_lns">
            <div class="sheet-row">
                <div class="sheet-item" style="width:30%"><input name="attr_LinguisticsNames" type="text" value="N/A" class='sheet-cell'></div>
                <div class="sheet-item" style="width:18%"><span>Intelligence</span></div>
                <div class="sheet-item" style="width:15%"><input name="attr_LinguisticsScores" type="number" value="0" class='sheet-cell sheet-spindisable' readonly></div>
                <div class="sheet-item" style="width:15%"><input name="attr_LinguisticsRanks" type="number" value="0" class='sheet-cell'></div>
                <div class="sheet-item" style="width:15%"><input name="attr_LinguisticsMiscs"  type="number" value="0" class='sheet-cell'></div>
            </div>
            </fieldset>
        </div>
    </div>
    
    <!--Second Row -->
    
    <div class='sheet-2colrow'>      
        <div class='sheet-col sheet-bg'>
        <span class="sheet-bg">
            <div class="sheet-row">
                <div class="sheet-item" style="width:90%"><span>Weapons</span></div>            
            </div>
            <fieldset class="repeating_weapons">
            <div class="sheet-row">
                <div class="sheet-item" style="width:38%"><span>Name</span></div>
                <div class="sheet-item" style="width:32%"><span>Rate of Fire</span></div>
                <div class="sheet-item" style="width:12%"><span>Range</span></div>
                <div class="sheet-item" style="width:10%"><span>Reload</span></div>
            </div>
            <div class="sheet-row">
                <div class="sheet-item" style="width:36%"><input name="attr_wpnnames" type="text" value="N/A" style="width:100%"></div>
                <div class="sheet-item sheet-spindisable" style="width:7%"><input name="attr_wpnsingleshots" type="text" value="N/A" style="width:100%"></div>
                <div class="sheet-item sheet-spindisable" style="width:2%"><span>/</span></div>
                <div class="sheet-item sheet-spindisable" style="width:7%"><input name="attr_wpnsemishots" type="text" value="N/A" style="width:100%"></div>
                <div class="sheet-item sheet-spindisable" style="width:2%"><span>/</span></div>
                <div class="sheet-item sheet-spindisable" style="width:7%"><input name="attr_wpnautoshots" type="text" value="N/A" style="width:100%"></div>
                <div class="sheet-item sheet-spindisable" style="width:15%"><input name="attr_wpnranges" type="number" value="N/A" style="width:100%"></div>
                <div class="sheet-item" style="width:15%">
                    <select style="width:100%" name="attr_wpnrlds">
                        <option value="na">N/A</option>
                        <option value="half">Half</option>
                        <option value="full">Full</option>
                        <option value="2full">2 Full</option>
                        <option value="3full">3 Full</option>
                    </select>
                </div>
            </div>
            <div class="sheet-row">
                <div class="sheet-item" style="width:48%"><span>Damage</span></div>
                <div class="sheet-item" style="width:10%"><span>Pen</span></div>
                <div class="sheet-item" style="width:21%"><span>Clip</span></div>
                <div class="sheet-item" style="width:10%"><span>Weight</span></div>
            </div>
            <div class="sheet-row">
                <div class="sheet-item sheet-spindisable" style="width:8%"><input name="attr_wpndmgnumdices" type="number" value="1" style="width:100%"></div>
                <div class="sheet-item sheet-spindisable" style="width:2%"><span>d</span></div>
                <div class="sheet-item sheet-spindisable" style="width:12%"><input name="attr_wpndmgdices" type="number" value="10" style="width:100%"></div>
                <div class="sheet-item sheet-spindisable" style="width:2%"><span>+</span></div>
                <div class="sheet-item sheet-spindisable" style="width:8%"><input name="attr_wpndmgstatics" type="number" value="0" style="width:100%"></div>
                <div class="sheet-item" style="width:10%">
                    <select style="width:100%" name="attr_wpndmgtypes">
                        <option value="impact">I</option>
                        <option value="rending">R</option>
                        <option value="energy">E</option>
                        <option value="explosive">X</option>
                    </select>
                </div>
                <div class="sheet-item sheet-spindisable" style="width:10%"><input name="attr_wpnpens" type="number" value="0" style="width:100%"></div>
                <div class="sheet-item sheet-spindisable" style="width:10%"><input name="attr_wpnclipcurs" type="number" value="0" style="width:100%"></div>
                <div class="sheet-item sheet-spindisable" style="width:10%"><input name="attr_wpnclipmaxs" type="number" value="0" style="width:100%"></div>
                <div class="sheet-item sheet-spindisable" style="width:10%"><input name="attr_wpnweights" type="text" value="0" style="width:100%"></div>
                <div class="sheet-item sheet-spindisable" style="width:5%"><input type="checkbox" name="attr_wpnselects" value="1" style="width: 100%"></div>

            </div>
            <div class="sheet-row">               
                <div class="sheet-item" style="width:80%"><span>Special</span></div>
                <div class="sheet-item" style="width:10%"><span>Quality</span></div>
            </div>
            <div class="sheet-row">                
                <div class="sheet-item" style="width:80%"><input name="attr_wpnspecials" type="text" value="N/A" style="width:100%"></div>
                <div class="sheet-item" style="width:14%">
                    <select style="width:100%" name="attr_wpnqualitys">
                        <option value="poor">Poor</option>
                        <option value="common">Common</option>
                        <option value="good">Good</option>
                        <option value="best">Best</option>
                    </select>
                </div>
            </div>
            </fieldset>
        </span>
        </div>
        <div class='sheet-col sheet-bg'>
            <div class="sheet-row">
                <div class="sheet-item" style="width:90%"><span>Psychic Powers</span></div>            
            </div>
            <fieldset class="repeating_powers">
            <div class="sheet-row">
                <div class="sheet-item" style="width:32%"><span>Name</span></div>
                <div class="sheet-item" style="width:15%"><span>Action</span></div>
                <div class="sheet-item" style="width:15%"><span>Atk Type</span></div>
                <div class="sheet-item" style="width:15%"><span>Range (xPR)</span></div>
                <div class="sheet-item" style="width:10%"><span>Focus</span></div>
            </div>
            <div class="sheet-row">
                <div class="sheet-item" style="width:32%"><input name="attr_psynames" type="text" value="N/A" style="width:100%"></div>
                <div class="sheet-item sheet-spindisable" style="width:15%">
                    <select style="width:100%" name="attr_psyactions">
                        <option value="free">Free</option>
                        <option value="reaction">Reaction</option>
                        <option value="half">Half</option>
                        <option value="full">Full</option>
                    </select>                
                </div>
                <div class="sheet-item sheet-spindisable" style="width:15%">
                    <select style="width:100%" name="attr_psyatktypes">
                        <option value="na">N/A</option>
                        <option value="bolt">Bolt</option>
                        <option value="barrage">Barrage</option>
                        <option value="storm">Storm</option>
                        <option value="blast">Blast</option>
                    </select>                
                </div>
                <div class="sheet-item sheet-spindisable" style="width:15%"><input name="attr_psyranges" type="number" value="N/A" style="width:100%"></div>
                <div class="sheet-item" style="width:10%"><input name="attr_psyfocuss" type="number" value="0" style="width:100%"></div>
                <div class="sheet-item sheet-spindisable" style="width:5%"><input type="checkbox" name="attr_psyselects" value="1" style="width: 100%"></div>
            </div>
            <div class="sheet-row">
                <div class="sheet-item" style="width:15%"><span>Sustain</span></div>
                <div class="sheet-item" style="width:28%"><span>Subtype</span></div>
                <div class="sheet-item" style="width:30%"><span>Damage(Xd10+Y+ZxPR)</span></div>
                <div class="sheet-item" style="width:20%"><span>Pen(X+YxPR)</span></div>
            </div>
            <div class="sheet-row">
                
                <div class="sheet-item" style="width:15%">
                    <select style="width:100%" name="attr_psysustains">
                        <option value="N/A">N/A</option>
                        <option value="free">Free</option>
                        <option value="reaction">Reaction</option>
                        <option value="half">Half</option>
                        <option value="full">Full</option>
                    </select>   
                </div>
                <div class="sheet-item" style="width:28%"><input name="attr_psysubtypes" type="text" value="N/A" style="width:100%"></div>
                <div class="sheet-item" style="width:10%"><input name="attr_psydmgflats" type="text" value="N/A" style="width:100%"></div>
                <div class="sheet-item" style="width:10%"><input name="attr_psydmgstats" type="number" value="0" style="width:100%"></div>
                <div class="sheet-item" style="width:10%"><input name="attr_psydmgprs" type="number" value="0" style="width:100%"></div>
                <div class="sheet-item" style="width:10%"><input name="attr_psypens" type="number" value="0" style="width:100%"></div>
                <div class="sheet-item" style="width:10%"><input name="attr_psypenprs" type="number" value="0" style="width:100%"></div>
            </div>
            <div class="sheet-row"> 
                <div class="sheet-item" style="width:15%"><span>Type</span></div>
                <div class="sheet-item" style="width:78%"><span>Attributes</span></div>
            </div>
            <div class="sheet-row">
                <div class="sheet-item sheet-spindisable" style="width:15%">
                    <select style="width:100%" name="attr_psydmgtypes">
                        <option value="E">Energy</option>
                        <option value="I">Impact</option>
                        <option value="X">Explosive</option>
                        <option value="R">Rending</option>
                    </select>                
                </div>                
                <div class="sheet-item" style="width:78%"><input name="attr_psyattrs" type="text" value="N/A" style="width:100%"></div>
            </div>
            <div class="sheet-row">               
                <div class="sheet-item" style="width:100%"><span>Effects</span></div>
            </div>
            <div class="sheet-row">                
                <textarea class="sheet-item" name="attr_psyeffects" style="width:90%"></textarea>
            </div>
            </fieldset>
        </div>
    </div>
    
    <!--Third Row -->
    
    <div class='sheet-2colrow'>
        <div class='sheet-col sheet-bg'>
            <div class="sheet-row">
                <div class="sheet-item" style="width:90%"><span>Equipment</span></div>            
            </div>
            <div class="sheet-row">
                <div class="sheet-item" style="width:86%"><span>Item</span></div>
                <div class="sheet-item" style="width:10%"><span>Weight</span></div>
            </div>
            <fieldset class="repeating_equipment">
            <div class="sheet-row">
                <div class="sheet-item" style="width:26%"><input name="attr_equipnames" type="text" value="N/A" style="width:100%"></div>
    			<div class="sheet-item" style="width:55%"><input name="attr_equipdescs" type="text" value="N/A" style="width:100%"></div>
                <div class="sheet-item" style="width:10%"><input name="attr_equipweights" type="text" value="N/A" style="width:100%"></div>
                <div class="sheet-item" style="width:5%"><input type="checkbox" name="attr_equipselects" value="1" style="width: 100%"></div>
            </div>
            </fieldset>
        </div>
        <div class='sheet-col sheet-bg'>
            <div class="sheet-row">
                <div class="sheet-item" style="width:90%"><span>Talents & Traits</span></div>            
            </div>
            <div class="sheet-row">
                <div class="sheet-item" style="width:60%"><span>Name</span></div>
                <div class="sheet-item" style="width:30%"><span>Description</span></div>
            </div>
            <fieldset class="repeating_talents">
            <div class="sheet-row">
                <div class="sheet-item" style="width:30%">
                    <select style="width:100%" name="attr_talentnames">
                        <optgroup label="tier1talents">
                            <option value="ambidexterous">Ambidexterous</option>
                            <option value="blindfighting">Blind Fighting</option>
                            <option value="catfall">Catfall</option>
                            <option value="cluesfromcrowds">Clues from the Crowds</option>
                            <option value="diehard">Die Hard</option>
                            <option value="disarm">Disarm</option>
                            <option value="doubleteam">Double Team</option>
                            <option value="enemy">Enemy</option>
                            <option value="ferricsummons">Ferric Summons</option>
                            <option value="frenzy">Frenzy</option>
                            <option value="ironjaw">Iron Jaw</option>
                            <option value="jaded">Jaded</option>
                            <option value="keenintuition">Keen Intuition</option>
                            <option value="leapup">Leap Up</option>
                            <option value="nowheretohide">Nowhere to Hide</option>
                            <option value="peer">Peer</option>
                            <option value="quickdraw">Quick Draw</option>
                            <option value="rapidreload">Rapid Reload</option>
                            <option value="resistance">Resistance</option>
                            <option value="soundconstitution">Sound Constitution</option>
                            <option value="takedown">Takedown</option>
                            <option value="technicalknock">Technical Knock</option>
                            <option value="warpsense">Warp Sense</option>
                            <option value="weapontech">Weapon Tech</option>
                            <option value="weapontraining">Weapon Training</option>
                            <option value="customtier1">CUSTOM TIER 1</option>
                        </optgroup>
                        <optgroup label="tier2talents">
                            <option value="armormonger">Armor Monger</option>
                            <option value="battlerage">Battle Rage</option>
                            <option value="bulgingbiceps">Bulging Biceps</option>
                            <option value="combatmaster">Combat Master</option>
                            <option value="constantvigilance">Constant Vigilance</option>
                            <option value="contactnetwork">Contact Network</option>
                            <option value="coordinatedinterrogation">Coordinated Interrogation</option>
                            <option value="counterattack">Counter Attack</option>
                            <option value="coverup">Cover Up</option>
                            <option value="denythewitch">Deny the Witch</option>
                            <option value="devastatingassault">Devastating Assault</option>
                            <option value="doubletap">Double Tap</option>
                            <option value="exoticweapontraining">Exotic Weapon Training</option>
                            <option value="faceinacrowd">Face in a Crowd</option>
                            <option value="hardtarget">Hard Target</option>
                            <option value="hardy">Hardy</option>
                            <option value="hatred">Hatred</option>
                            <option value="hipshooting">Hip Shooting</option>
                            <option value="independenttargeting">Independent Targeting</option>
                            <option value="inescapableattack">Inescapable Attack</option>
                            <option value="killingstrike">Killing Strike</option>
                            <option value="luminenshock">Luminen Shock</option>
                            <option value="maglevtranscendence">Maglev Transcendence</option>
                            <option value="marksman">Marksman</option>
                            <option value="mechadendriteuse">Mechadendrite Use</option>
                            <option value="precisionkiller">Precision Killer</option>
                            <option value="prosanguine">Prosanguine</option>
                            <option value="strongminded">Strong Minded</option>
                            <option value="swiftattack">Swift Attack</option>
                            <option value="twoweaponwielder">Two Weapon Wielder</option>
                            <option value="unarmedspecialist">Unarmed Specialist</option>
                            <option value="warpconduit">Warp Conduit</option>
                            <option value="whirlwindofdeath">Whirlwind of Death</option>
                            <option value="customtier2">CUSTOM TIER 2</option>
                        </optgroup>
                        <optgroup label="tier3talents">
                            <option value="adamantiumfaith">Adamantium Faith</option>
                            <option value="assassinstrike">Assassin Strike</option>
                            <option value="bastionofironwill">Bastion of Iron Will</option>
                            <option value="blademaster">Blademaster</option>
                            <option value="crushingblow">Crushing Blow</option>
                            <option value="deathdealer">Deathdealer</option>
                            <option value="delicateinterrogation">Delicate Interrogation</option>
                            <option value="eyeofvengeance">Eye of Vengeance</option>
                            <option value="favouredbythewarp">Favoured by the Warp</option>
                            <option value="flashofinsight">Flash of Insight</option>
                            <option value="haloofcommand">Halo of Command</option>
                            <option value="hammerblow">Hammer Blow</option>
                            <option value="infusedknowledge">Infused Knowledge</option>
                            <option value="lightningattack">Lightning Attack</option>
                            <option value="luminenblast">Luminen Blast</option>
                            <option value="mastery">Mastery</option>
                            <option value="mightyshot">Mighty Shot</option>
                            <option value="neverdie">Never Die</option>
                            <option value="preternaturalspeed">Preternatural Speed</option>
                            <option value="sprint">Sprint</option>
                            <option value="stepaside">Step Aside</option>
                            <option value="superiorchirurgeon">Superior Chirurgeon</option>
                            <option value="targetselection">Target Selection</option>
                            <option value="thundercharge">Thunder Charge</option>
                            <option value="truegrit">True Grit</option>
                            <option value="twoweaponmaster">Two Weapon Master</option>
                            <option value="warplock">Warp Lock</option>
                            <option value="customtier3">CUSTOM TIER 3</option>
                        </optgroup>
                    </select>                     
                </div>
                <div class="sheet-item" style="width:60%"><input name="attr_talentdescs" type="text" style="width:100%"></div>
            </div>
            </fieldset>
        </div> 
    </div>
    
    <!--Fourth Row -->
    
    <div class='sheet-3colrow'>
        <div class='sheet-col sheet-bg'>
            <div class="sheet-row">
                <div class="sheet-item" style="width:90%"><span>Mutations, Malignancies, & Disorders</span></div>            
            </div>
            <div class="sheet-row">
                <div class="sheet-item" style="width:30%"><span>Name</span></div>
                <div class="sheet-item" style="width:60%"><span>Description</span></div>
            </div>
            <fieldset class="repeating_mutation">
            <div class="sheet-row">
                <div class="sheet-item" style="width:30%"><input name="attr_mutnames" type="text" style="width:100%"></div>
                <div class="sheet-item" style="width:60%"><input name="attr_mutdescs" type="text" style="width:100%"></div>
            </div>
            </fieldset>
        </div>
        <div class='sheet-col sheet-bg'>
            <div class="sheet-row">
                <div class="sheet-item" style="width:90%"><span>Weapon Proficiencies</span></div>            
            </div>
            <fieldset class="repeating_profs">
            <div class="sheet-row">
                <div class="sheet-item" style="width:90%"><input name="attr_wpnprofs" type="text" style="width:100%"></div>
            </div>
            </fieldset>
        </div>
    </div>
</div>


<!--Third Sheet -- Ship Charactersheet-->


<div class="sheet-shipwrapper">
    <div class='sheet-2colrow'>
        <div class='sheet-col sheet-bg sheet-playerfill'>
            <div class="sheet-row">
                <div class="sheet-item" style="width:30%"><span>Ship</span></div>
                <div class="sheet-item" style="width:60%"><input name="attr_shipname" type="text" style="width:100%"></div>
            </div>
            <div class="sheet-row">
                <div class="sheet-item" style="width:30%"><span>Affiliation</span></div>
                <div class="sheet-item" style="width:60%"><input name="attr_shipaff" type="text" style="width:100%"></div>
            </div>
            <div class="sheet-row">
                <div class="sheet-item" style="width:30%"><span>Captain</span></div>
                <div class="sheet-item" style="width:60%"><input name="attr_shipcpt" type="text" style="width:100%"></div>
            </div>
            <div class="sheet-row">
                <div class="sheet-item" style="width:30%"><span>History</span></div>
                <div class="sheet-item" style="width:60%"><input name="attr_shiphist" type="text" style="width:100%"></div>
            </div>
            <div class="sheet-row">
                <div class="sheet-item" style="width:30%"><span>Complication</span></div>
                <div class="sheet-item" style="width:60%"><input name="attr_shipcomp" type="text" style="width:100%"></div>
            </div>
        </div>
        <div class='sheet-col sheet-bg sheet-playerfill'>
            <div class="sheet-row">
                <div class="sheet-item" style="width:30%"><span>Stats</span></div>
                <div class="sheet-item" style="width:30%"><span>Defenses</span></div>
                <div class="sheet-item" style="width:30%"><span>Crew</span></div>
            </div>
            <div class="sheet-row">
                <div class="sheet-item" style="width:30%"><span>Integrity:</span><input name="attr_shipcurinteg" type="number" style="width:40%"><span style="width:2%">/</span><input name="attr_shipmaxinteg" type="number" style="width:40%"></div>
                <div class="sheet-item" style="width:30%"><span>Armor:</span><input name="attr_shiparmor" type="number" style="width:100%"></div>
                <div class="sheet-item" style="width:30%"><span>Morale:</span><input name="attr_shipmorale" type="number" style="width:100%">></div>
            </div>
            <div class="sheet-row">
                <div class="sheet-item" style="width:30%"><span>Maneuv:</span><input name="attr_shiparmor" type="number" style="width:100%"></div>
                <div class="sheet-item" style="width:30%"><span>Shields:</span><input name="attr_shipshields" type="number" style="width:100%"></div>
                <div class="sheet-item" style="width:30%"><span>Rating:</span><input name="attr_shiprating" type="number" style="width:100%"></div>
            </div>
            <div class="sheet-row">
                <div class="sheet-item" style="width:30%"><span>Speed:</span><input name="attr_shipspeed" type="number" style="width:100%"></div>
                <div class="sheet-item" style="width:30%"><span>Turrets:</span><input name="attr_shipturrets" type="number" style="width:100%"></div>
                <div class="sheet-item" style="width:30%"><span>Population:</span><input name="attr_shippop" type="number" style="width:100%"></div>
            </div>
            <div class="sheet-row">
                <div class="sheet-item" style="width:30%"><span>Detection:</span><input name="attr_shipdet" type="number" style="width:100%"></div>
            </div>
        </div>
    </div>
</div>











<rolltemplate class="sheet-rolltemplate-check">
    <div>
    <table>
        <thead>
            <tr><th>{{charname}}</th></tr>
		    <tr><th><span class="header">{{rollname}} - {{attributename}} {{attributevalue}}</span></th></tr>
		</thead>
		<tbody>
		    {{#rollLess() check 0}}
		    <tr><td><span class="bold">Test:</span> {{check}} <span class="red"> - 1 Degrees of Failure</span></td></tr>
		    <tr><td>Your {{rollname}} has failed. Ouch.</td></tr>
		    {{/rollLess() check 0}}
		
		    {{#rollGreater() check -1}}
		    <tr><td><span class="bold">Test:</span> {{check}} <span class="green"> + 1 Degrees of Success</span></td></tr>
		    <tr><td>Your {{rollname}} has succeeded! But was it enough?</td></tr>
		    {{/rollGreater() check -1}}
        </tbody>
    </table>
    </div>
</rolltemplate>






















<script type="text/worker">

on('sheet:opened',function(){
  getAttrs(["Intelligence", "Intelligenceadj"], function(values) {
    self.kirk = self.kirk || {};
    self.kirk.Intelligence = values.Intelligence;
    self.kirk.Intelligenceadj = values.Intelligenceadj;
  });
});




/////////////////////////////////////////
//
//Repeating Skills Section Workers
//
//////////////////////////////////////////

//Latches any changed int values for lore calculations and update repeating skill calculations (all Int-based)
on("change:intelligence change:intelligenceadj", function() {
    getAttrs(["Intelligence", "Intelligenceadj"], function(values) {
        self.kirk = self.kirk || {};
        self.kirk.Intelligence = values.Intelligence;
        self.kirk.Intelligenceadj = values.Intelligenceadj;
        //Common Lores
        getSectionIDs("repeating_cls", function(clarray) {
            _.each(clarray, function(currentID, i) {
                getAttrs([
                "repeating_cls_" + currentID + "_commonloreranks",
                "repeating_cls_" + currentID + "_commonloremiscs",
                "repeating_cls_" + currentID + "_commonlorescores"
                ], function(a) {   
                    var tempmod = 10;
                    tempmod = parseInt(a["repeating_cls_" + currentID + "_commonloreranks"]);
                    if (tempmod == 0) {tempmod = -20;} 
                    else if (tempmod == 1 || tempmod == 2 || tempmod == 3 || tempmod == 4) {tempmod = (tempmod - 1) * 10;} 
                    else {tempmod = -900;}
                    var Intelligence = self.kirk.Intelligence;
                    var Intelligenceadj = self.kirk.Intelligenceadj;
                    var update = {};
                    update["repeating_cls_" + currentID + "_commonlorescores"] = (parseInt(Intelligence) + parseInt(Intelligenceadj) + parseInt(a["repeating_cls_" + currentID + "_commonloremiscs"]) + tempmod);
                    setAttrs(update);
                });
            });
        });
		//Forbidden Lores
		getSectionIDs("repeating_fls", function(flarray) {
            _.each(flarray, function(currentID, i) {
                getAttrs([
                "repeating_fls_" + currentID + "_forbiddenloreranks",
                "repeating_fls_" + currentID + "_forbiddenloremiscs",
                "repeating_fls_" + currentID + "_forbiddenlorescores"
                ], function(a) {   
                    var tempmod = 10;
                    tempmod = parseInt(a["repeating_fls_" + currentID + "_forbiddenloreranks"]);
                    if (tempmod == 0) {tempmod = -20;} 
                    else if (tempmod == 1 || tempmod == 2 || tempmod == 3 || tempmod == 4) {tempmod = (tempmod - 1) * 10;} 
                    else {tempmod = -900;}
                    var Intelligence = self.kirk.Intelligence;
                    var Intelligenceadj = self.kirk.Intelligenceadj;
                    var update = {};
                    update["repeating_fls_" + currentID + "_forbiddenlorescores"] = (parseInt(Intelligence) + parseInt(Intelligenceadj) + parseInt(a["repeating_fls_" + currentID + "_forbiddenloremiscs"]) + tempmod);
                    setAttrs(update);
                });
            });
        });
		//Scholastic Lores
		getSectionIDs("repeating_sls", function(slarray) {
            _.each(slarray, function(currentID, i) {
                getAttrs([
                "repeating_sls_" + currentID + "_scholasticloreranks",
                "repeating_sls_" + currentID + "_scholasticloremiscs",
                "repeating_sls_" + currentID + "_scholasticlorescores"
                ], function(a) {   
                    var tempmod = 10;
                    tempmod = parseInt(a["repeating_sls_" + currentID + "_scholasticloreranks"]);
                    if (tempmod == 0) {tempmod = -20;} 
                    else if (tempmod == 1 || tempmod == 2 || tempmod == 3 || tempmod == 4) {tempmod = (tempmod - 1) * 10;} 
                    else {tempmod = -900;}
                    var Intelligence = self.kirk.Intelligence;
                    var Intelligenceadj = self.kirk.Intelligenceadj;
                    var update = {};
                    update["repeating_sls_" + currentID + "_scholasticlorescores"] = (parseInt(Intelligence) + parseInt(Intelligenceadj) + parseInt(a["repeating_sls_" + currentID + "_scholasticloremiscs"]) + tempmod);
                    setAttrs(update);
                });
            });
        });
        //Linguistics
        getSectionIDs("repeating_lns", function(lnarray) {
            _.each(lnarray, function(currentID, i) {
                getAttrs([
                "repeating_lns_" + currentID + "_linguisticsranks",
                "repeating_lns_" + currentID + "_linguisticsmiscs",
                "repeating_lns_" + currentID + "_linguisticsscores"
                ], function(a) {   
                    var tempmod = 10;
                    tempmod = parseInt(a["repeating_lns_" + currentID + "_linguisticsranks"]);
                    if (tempmod == 0) {tempmod = -20;} 
                    else if (tempmod == 1 || tempmod == 2 || tempmod == 3 || tempmod == 4) {tempmod = (tempmod - 1) * 10;} 
                    else {tempmod = -900;}
                    var Intelligence = self.kirk.Intelligence;
                    var Intelligenceadj = self.kirk.Intelligenceadj;
                    var update = {};
                    update["repeating_lns_" + currentID + "_linguisticsscores"] = (parseInt(Intelligence) + parseInt(Intelligenceadj) + parseInt(a["repeating_lns_" + currentID + "_linguisticsmiscs"]) + tempmod);
                    setAttrs(update);
                });
            });
        });
    });
});



//
//COMMON LORE WORKERS
//



//Calculates the score for each individual CL
on("change:repeating_cls:commonloreranks change:repeating_cls:commonloremiscs", function() {
    getAttrs(["repeating_cls_commonloreranks", "repeating_cls_commonloremiscs", "repeating_cls_commonlorescores"], function(values) {
        var tempmod = 10;
        tempmod = parseInt(values.repeating_cls_commonloreranks);
        if (tempmod == 0) {tempmod = -20;} 
        else if (tempmod == 1 || tempmod == 2 || tempmod == 3 || tempmod == 4) {tempmod = (tempmod - 1) * 10;} 
        else {tempmod = -900;}
        var Intelligence = self.kirk.Intelligence;
        var Intelligenceadj = self.kirk.Intelligenceadj;
        setAttrs({
            repeating_cls_commonlorescores: (parseInt(Intelligence) + parseInt(Intelligenceadj) + parseInt(values.repeating_cls_commonloremiscs) + tempmod)
        });
    });
});


//Common Lore: Update display CLs when input sheet values for CLs change
on("change:repeating_cls:commonlorescores change:repeating_cls:commonlorenames",function(){
    getSectionIDs("repeating_cls", function(clarray) {
        getSectionIDs("repeating_cldisps", function(cldisparray) {
            var input = clarray.length;
            var disp  = cldisparray.length;
            _.each(clarray, function(currentID, i) {
                getAttrs([
                "repeating_cls_" + currentID + "_commonlorescores",
                "repeating_cls_" + currentID + "_commonlorenames"
                ], function(a) {
                    getAttrs([
                    "repeating_cldisps_" + cldisparray[i] + "_dispcommonlorescores",
                    "repeating_cldisps_" + cldisparray[i] + "_dispcommonlorenames"
                    ], function(b) {
                        var disprowattrs = {};
                        disprowattrs["repeating_cldisps_" + cldisparray[i] + "_dispcommonlorenames"] = a["repeating_cls_" + currentID + "_commonlorenames"];
                        disprowattrs["repeating_cldisps_" + cldisparray[i] + "_dispcommonlorescores"] = a["repeating_cls_" + currentID + "_commonlorescores"];
                        setAttrs(disprowattrs);
                    });    
                });
			});
        });
    });
});


//Update CL display when CL input rows are added
on("change:repeating_cls remove:repeating_cls",function(eventInfo){
    getSectionIDs("repeating_cls", function(clarray) {
        getSectionIDs("repeating_cldisps", function(cldisparray) {
            var input = clarray.length;
            var disp  = cldisparray.length;
            //add extra display rows
            if(input > disp){
                _.each(clarray, function(currentID, i) {
                    if(i>= disp) {
                        var newrowid = generateRowID();
                        var newrowattrs = {};
                        getAttrs(["repeating_cls_" + currentID + "_commonlorenames"], function(y) {
                            newrowattrs["repeating_cldisps_" + newrowid + "_dispcommonlorenames"] = y["repeating_cls_" + currentID + "_commonlorenames"];
                            setAttrs(newrowattrs);
                        });
                    }
                });
            }
            else if(disp > input) {
                getSectionIDs("repeating_cldisps", function(idarray) {
                    for(var i=0; i < idarray.length; i++) {
                        if(i>= input) {
                            removeRepeatingRow("repeating_cldisps_" + idarray[i]);
                        }
                    }
                });
                _.each(clarray, function(currentID, i) {
                    getAttrs([
                    "repeating_cls_" + currentID + "_commonlorescores",
                    "repeating_cls_" + currentID + "_commonlorenames"
                    ], function(a) {
                        getAttrs([
                        "repeating_cldisps_" + cldisparray[i] + "_dispcommonlorescores",
                        "repeating_cldisps_" + cldisparray[i] + "_dispcommonlorenames"
                        ], function(b) {
                            var disprowattrs = {};
                            disprowattrs["repeating_cldisps_" + cldisparray[i] + "_dispcommonlorenames"] = a["repeating_cls_" + currentID + "_commonlorenames"];
                            disprowattrs["repeating_cldisps_" + cldisparray[i] + "_dispcommonlorescores"] = a["repeating_cls_" + currentID + "_commonlorescores"];
                            setAttrs(disprowattrs);
                        });    
                    });
			    });
            }
        });
    });
});

//
//FORBIDDEN LORE WORKERS
//



//Calculates the score for each individual FL
on("change:repeating_fls:forbiddenloreranks change:repeating_fls:forbiddenloremiscs", function() {
    getAttrs(["repeating_fls_forbiddenloreranks", "repeating_fls_forbiddenloremiscs", "repeating_fls_forbiddenlorescores"], function(values) {
        var tempmod = 10;
        tempmod = parseInt(values.repeating_fls_forbiddenloreranks);
        if (tempmod == 0) {tempmod = -20;} 
        else if (tempmod == 1 || tempmod == 2 || tempmod == 3 || tempmod == 4) {tempmod = (tempmod - 1) * 10;} 
        else {tempmod = -900;}
        var Intelligence = self.kirk.Intelligence;
        var Intelligenceadj = self.kirk.Intelligenceadj;
        setAttrs({
            repeating_fls_forbiddenlorescores: (parseInt(Intelligence) + parseInt(Intelligenceadj) + parseInt(values.repeating_fls_forbiddenloremiscs) + tempmod)
        });
    });
});


//Update display FLs when input sheet values for FLs change
on("change:repeating_fls:forbiddenlorescores change:repeating_fls:forbiddenlorenames",function(){
    getSectionIDs("repeating_fls", function(flarray) {
        getSectionIDs("repeating_fldisps", function(fldisparray) {
            var input = flarray.length;
            var disp  = fldisparray.length;
            _.each(flarray, function(currentID, i) {
                getAttrs([
                "repeating_fls_" + currentID + "_forbiddenlorescores",
                "repeating_fls_" + currentID + "_forbiddenlorenames"
                ], function(a) {
                    getAttrs([
                    "repeating_fldisps_" + fldisparray[i] + "_dispforbiddenlorescores",
                    "repeating_fldisps_" + fldisparray[i] + "_dispforbiddenlorenames"
                    ], function(b) {
                        var disprowattrs = {};
                        disprowattrs["repeating_fldisps_" + fldisparray[i] + "_dispforbiddenlorenames"] = a["repeating_fls_" + currentID + "_forbiddenlorenames"];
                        disprowattrs["repeating_fldisps_" + fldisparray[i] + "_dispforbiddenlorescores"] = a["repeating_fls_" + currentID + "_forbiddenlorescores"];
                        setAttrs(disprowattrs);
                    });    
                });
			});
        });
    });
});


//Update FL display when FL input rows are added
on("change:repeating_fls remove:repeating_fls",function(eventInfo){
    getSectionIDs("repeating_fls", function(flarray) {
        getSectionIDs("repeating_fldisps", function(fldisparray) {
            var input = flarray.length;
            var disp  = fldisparray.length;
            //add extra display rows
            if(input > disp){
                _.each(flarray, function(currentID, i) {
                    if(i>= disp) {
                        var newrowid = generateRowID();
                        var newrowattrs = {};
                        getAttrs(["repeating_fls_" + currentID + "_forbiddenlorenames"], function(y) {
                            newrowattrs["repeating_fldisps_" + newrowid + "_dispforbiddenlorenames"] = y["repeating_fls_" + currentID + "_forbiddenlorenames"];
                            setAttrs(newrowattrs);
                        });
                    }
                });
            }
            else if(disp > input) {
                getSectionIDs("repeating_fldisps", function(idarray) {
                    for(var i=0; i < idarray.length; i++) {
                        if(i>= input) {
                            removeRepeatingRow("repeating_fldisps_" + idarray[i]);
                        }
                    }
                });
                _.each(flarray, function(currentID, i) {
                    getAttrs([
                    "repeating_fls_" + currentID + "_forbiddenlorescores",
                    "repeating_fls_" + currentID + "_forbiddenlorenames"
                    ], function(a) {
                        getAttrs([
                        "repeating_fldisps_" + fldisparray[i] + "_dispforbiddenlorescores",
                        "repeating_fldisps_" + fldisparray[i] + "_dispforbiddenlorenames"
                        ], function(b) {
                            var disprowattrs = {};
                            disprowattrs["repeating_fldisps_" + fldisparray[i] + "_dispforbiddenlorenames"] = a["repeating_fls_" + currentID + "_forbiddenlorenames"];
                            disprowattrs["repeating_fldisps_" + fldisparray[i] + "_dispforbiddenlorescores"] = a["repeating_fls_" + currentID + "_forbiddenlorescores"];
                            setAttrs(disprowattrs);
                        });    
                    });
			    });
            }
        });
    });
});



//
//SCHOLASTIC LORE WORKERS
//



//Calculates the score for each individual SL
on("change:repeating_sls:scholasticloreranks change:repeating_sls:scholasticloremiscs", function() {
    getAttrs(["repeating_sls_scholasticloreranks", "repeating_sls_scholasticloremiscs", "repeating_sls_scholasticlorescores"], function(values) {
        var tempmod = 10;
        tempmod = parseInt(values.repeating_sls_scholasticloreranks);
        if (tempmod == 0) {tempmod = -20;} 
        else if (tempmod == 1 || tempmod == 2 || tempmod == 3 || tempmod == 4) {tempmod = (tempmod - 1) * 10;} 
        else {tempmod = -900;}
        var Intelligence = self.kirk.Intelligence;
        var Intelligenceadj = self.kirk.Intelligenceadj;
        setAttrs({
            repeating_sls_scholasticlorescores: (parseInt(Intelligence) + parseInt(Intelligenceadj) + parseInt(values.repeating_sls_scholasticloremiscs) + tempmod)
        });
    });
});


//Update display SLs when input sheet values for SLs change
on("change:repeating_sls:scholasticlorescores change:repeating_sls:scholasticlorenames",function(){
    getSectionIDs("repeating_sls", function(slarray) {
        getSectionIDs("repeating_sldisps", function(sldisparray) {
            var input = slarray.length;
            var disp  = sldisparray.length;
            _.each(slarray, function(currentID, i) {
                getAttrs([
                "repeating_sls_" + currentID + "_scholasticlorescores",
                "repeating_sls_" + currentID + "_scholasticlorenames"
                ], function(a) {
                    getAttrs([
                    "repeating_sldisps_" + sldisparray[i] + "_dispscholasticlorescores",
                    "repeating_sldisps_" + sldisparray[i] + "_dispscholasticlorenames"
                    ], function(b) {
                        var disprowattrs = {};
                        disprowattrs["repeating_sldisps_" + sldisparray[i] + "_dispscholasticlorenames"] = a["repeating_sls_" + currentID + "_scholasticlorenames"];
                        disprowattrs["repeating_sldisps_" + sldisparray[i] + "_dispscholasticlorescores"] = a["repeating_sls_" + currentID + "_scholasticlorescores"];
                        setAttrs(disprowattrs);
                    });    
                });
			});
        });
    });
});


//Update SL display when SL input rows are added
on("change:repeating_sls remove:repeating_sls",function(eventInfo){
    getSectionIDs("repeating_sls", function(slarray) {
        getSectionIDs("repeating_sldisps", function(sldisparray) {
            var input = slarray.length;
            var disp  = sldisparray.length;
            //add extra display rows
            if(input > disp){
                _.each(slarray, function(currentID, i) {
                    if(i>= disp) {
                        var newrowid = generateRowID();
                        var newrowattrs = {};
                        getAttrs(["repeating_sls_" + currentID + "_scholasticlorenames"], function(y) {
                            newrowattrs["repeating_sldisps_" + newrowid + "_dispscholasticlorenames"] = y["repeating_sls_" + currentID + "_scholasticlorenames"];
                            setAttrs(newrowattrs);
                        });
                    }
                });
            }
            else if(disp > input) {
                getSectionIDs("repeating_sldisps", function(idarray) {
                    for(var i=0; i < idarray.length; i++) {
                        if(i>= input) {
                            removeRepeatingRow("repeating_sldisps_" + idarray[i]);
                        }
                    }
                });
                _.each(slarray, function(currentID, i) {
                    getAttrs([
                    "repeating_sls_" + currentID + "_scholasticlorescores",
                    "repeating_sls_" + currentID + "_scholasticlorenames"
                    ], function(a) {
                        getAttrs([
                        "repeating_sldisps_" + sldisparray[i] + "_dispscholasticlorescores",
                        "repeating_sldisps_" + sldisparray[i] + "_dispscholasticlorenames"
                        ], function(b) {
                            var disprowattrs = {};
                            disprowattrs["repeating_sldisps_" + sldisparray[i] + "_dispscholasticlorenames"] = a["repeating_sls_" + currentID + "_scholasticlorenames"];
                            disprowattrs["repeating_sldisps_" + sldisparray[i] + "_dispscholasticlorescores"] = a["repeating_sls_" + currentID + "_scholasticlorescores"];
                            setAttrs(disprowattrs);
                        });    
                    });
			    });
            }
        });
    });
});



//
//LINGUISTICS WORKERS
//



//Calculates the score for each individual LN
on("change:repeating_lns:linguisticsranks change:repeating_lns:linguisticsmiscs", function() {
    getAttrs(["repeating_lns_linguisticsranks", "repeating_lns_linguisticsmiscs", "repeating_lns_linguisticsscores"], function(values) {
        var tempmod = 10;
        tempmod = parseInt(values.repeating_lns_linguisticsranks);
        if (tempmod == 0) {tempmod = -20;} 
        else if (tempmod == 1 || tempmod == 2 || tempmod == 3 || tempmod == 4) {tempmod = (tempmod - 1) * 10;} 
        else {tempmod = -900;}
        var Intelligence = self.kirk.Intelligence;
        var Intelligenceadj = self.kirk.Intelligenceadj;
        setAttrs({
            repeating_lns_linguisticsscores: (parseInt(Intelligence) + parseInt(Intelligenceadj) + parseInt(values.repeating_lns_linguisticsmiscs) + tempmod)
        });
    });
});


//Update display LNs when input sheet values for LNs change
on("change:repeating_lns:linguisticsscores change:repeating_lns:linguisticsnames",function(){
    getSectionIDs("repeating_lns", function(lnarray) {
        getSectionIDs("repeating_lndisps", function(lndisparray) {
            var input = lnarray.length;
            var disp  = lndisparray.length;
            _.each(lnarray, function(currentID, i) {
                getAttrs([
                "repeating_lns_" + currentID + "_linguisticsscores",
                "repeating_lns_" + currentID + "_linguisticsnames"
                ], function(a) {
                    getAttrs([
                    "repeating_lndisps_" + lndisparray[i] + "_displinguisticsscores",
                    "repeating_lndisps_" + lndisparray[i] + "_displinguisticsnames"
                    ], function(b) {
                        var disprowattrs = {};
                        disprowattrs["repeating_lndisps_" + lndisparray[i] + "_displinguisticsnames"] = a["repeating_lns_" + currentID + "_linguisticsnames"];
                        disprowattrs["repeating_lndisps_" + lndisparray[i] + "_displinguisticsscores"] = a["repeating_lns_" + currentID + "_linguisticsscores"];
                        setAttrs(disprowattrs);
                    });    
                });
			});
        });
    });
});

on("change:repeating_lns remove:repeating_lns",function(eventInfo){
    getSectionIDs("repeating_lns", function(lnarray) {
        getSectionIDs("repeating_lndisps", function(lndisparray) {
            var input = lnarray.length;
            var disp  = lndisparray.length;
            //add extra display rows
            if(input > disp){
                _.each(lnarray, function(currentID, i) {
                    if(i>= disp) {
                        var newrowid = generateRowID();
                        var newrowattrs = {};
                        getAttrs(["repeating_lns_" + currentID + "_linguisticsnames"], function(y) {
                            newrowattrs["repeating_lndisps_" + newrowid + "_displinguisticsnames"] = y["repeating_lns_" + currentID + "_linguisticsnames"];
                            setAttrs(newrowattrs);
                        });
                    }
                });
            }
            else if(disp > input) {
                getSectionIDs("repeating_lndisps", function(idarray) {
                    for(var i=0; i < idarray.length; i++) {
                        if(i>= input) {
                            removeRepeatingRow("repeating_lndisps_" + idarray[i]);
                        }
                    }
                });
                _.each(lnarray, function(currentID, i) {
                    getAttrs([
                    "repeating_lns_" + currentID + "_linguisticsscores",
                    "repeating_lns_" + currentID + "_linguisticsnames"
                    ], function(a) {
                        getAttrs([
                        "repeating_lndisps_" + lndisparray[i] + "_displinguisticsscores",
                        "repeating_lndisps_" + lndisparray[i] + "_displinguisticsnames"
                        ], function(b) {
                            var disprowattrs = {};
                            disprowattrs["repeating_lndisps_" + lndisparray[i] + "_displinguisticsnames"] = a["repeating_lns_" + currentID + "_linguisticsnames"];
                            disprowattrs["repeating_lndisps_" + lndisparray[i] + "_displinguisticsscores"] = a["repeating_lns_" + currentID + "_linguisticsscores"];
                            setAttrs(disprowattrs);
                        });    
                    });
			    });
            }
        });
    });
});


//////////////////////////
//
//WEAPON ROLL ICON VISIBILITY
//
//////////////////////////
//Single Shot
on("change:dispwpnsingleshot1", function() {
    getAttrs(["dispwpnsingleshot1"], function(values) {
        var wpnid1 =  values.dispwpnsingleshot1;
        if(wpnid1 == 'S') {
            setAttrs({wpnselsf1: 1});
        } else{
            setAttrs({wpnselsf1: 0});
        }
    });
});
on("change:dispwpnsingleshot2", function() {
    getAttrs(["dispwpnsingleshot2"], function(values) {
        var wpnid1 =  values.dispwpnsingleshot2;
        if(wpnid1 == 'S') {
            setAttrs({wpnselsf2: 1});
        } else{
            setAttrs({wpnselsf2: 0});
        }
    });
});
//Semi-Auto Shot
on("change:dispwpnsemishot1", function() {
    getAttrs(["dispwpnsemishot1"], function(values) {
        var wpnid1 =  parseInt(values.dispwpnsemishot1);
        if(wpnid1==0||wpnid1==1||wpnid1==2||wpnid1==3||wpnid1==4||wpnid1==5||wpnid1==6||wpnid1==7||wpnid1==8||wpnid1==9||wpnid1==10) {
            setAttrs({wpnselsa1: 1});
        } else{
            setAttrs({wpnselsa1: 0});
        }
    });
});
on("change:dispwpnsemishot2", function() {
    getAttrs(["dispwpnsemishot2"], function(values) {
        var wpnid1 =  parseInt(values.dispwpnsemishot2);
        if(wpnid1==0||wpnid1==1||wpnid1==2||wpnid1==3||wpnid1==4||wpnid1==5||wpnid1==6||wpnid1==7||wpnid1==8||wpnid1==9||wpnid1==10) {
            setAttrs({wpnselsa2: 1});
        } else{
            setAttrs({wpnselsa2: 0});
        }
    });
});
//Full-Auto Shot
on("change:dispwpnautoshot1", function() {
    getAttrs(["dispwpnautoshot1"], function(values) {
        var wpnid1 =  parseInt(values.dispwpnautoshot1);
        if(wpnid1==0||wpnid1==1||wpnid1==2||wpnid1==3||wpnid1==4||wpnid1==5||wpnid1==6||wpnid1==7||wpnid1==8||wpnid1==9||wpnid1==10) {
            setAttrs({wpnselfa1: 1});
        } else{
            setAttrs({wpnselfa1: 0});
        }
    });
});
on("change:dispwpnautoshot2", function() {
    getAttrs(["dispwpnautoshot2"], function(values) {
        var wpnid1 =  parseInt(values.dispwpnautoshot2);
        if(wpnid1==0||wpnid1==1||wpnid1==2||wpnid1==3||wpnid1==4||wpnid1==5||wpnid1==6||wpnid1==7||wpnid1==8||wpnid1==9||wpnid1==10) {
            setAttrs({wpnselfa2: 1});
        } else{
            setAttrs({wpnselfa2: 0});
        }
    });
});
//Maximal/Indirect/Swift/Lightning
on("change:dispwpnspecial1 ", function() {
    getAttrs(["dispwpnsingleshot1","dispwpnspecial1","talentstring"], function(values) {
        var specialArray = values.dispwpnspecial1.split(',');
        var ttArray=values.talentstring.split('.');
        var maximal=0;
        var indirect=0;
        var swift=0;
        var lightning=0;
        var unwieldy=0;
        var maximal = 0;
        var indirect = 0;
        var semi=false;
        var auto=false;
        var i;
        var qstring='';
        _.each(specialArray, function(current, i) {
            specialArray[i] = specialArray[i].replace(/^\s+|\s+$/g, '');    //remove whitespace
            specialArray[i] = specialArray[i].replace(/\(([^)]+)\)/g, '');  //remove parentheses and anything inside
            if(specialArray[i]=="Maximal"){maximal=1;}
            if(specialArray[i]=="Indirect"){indirect=1;}
        });
        
        _.each(ttArray, function(current, i) {
            ttArray[i] = ttArray[i].replace(/^\s+|\s+$/g, '');    //remove whitespace
            ttArray[i] = ttArray[i].replace(/\(([^)]+)\)/g, '');  //remove parentheses and anything inside
            if(ttArray[i]=="swiftattack"){swift=1;}
            if(ttArray[i]=="lightningattack"){lightning=1;}
            if(specialArray[i]=="Unwieldy"){unwieldy=1;}
            if(specialArray[i]=="Unbalanced"){unwieldy=1;}
        });
        
        if(maximal==1){
            setAttrs({wpnselmx1: 1});
            getAttrs(["dispwpnsingleshot1","dispwpnsemishot1","dispwpnautoshot1"], function(a) {
                if( (!isNaN(a.dispwpnautoshot1)) && a.dispwpnautoshot1>0 && a.dispwpnautoshot1<11){auto=true;}
                if( (!isNaN(a.dispwpnsemishot1)) && a.dispwpnsemishot1>0 && a.dispwpnsemishot1<11){semi=true;}

                if(a.dispwpnsingleshot1=='S' && semi==false && auto==false){qstring=6;}
                else if(a.dispwpnsingleshot1!='S' && semi==true && auto==false){qstring=7;}
                else if(a.dispwpnsingleshot1!='S' && semi==false && auto==true){qstring=8;}
                else {
                    qstring='?{Fire Selection(Maximal)';
                    if(a.dispwpnsingleshot1=='S'){qstring=qstring+'|Standard, 6';}
                    if(semi==true){qstring=qstring+'|Semi-Auto, 7';}
                    if(auto==true){qstring=qstring+'|Full-Auto, 8';}
                    qstring=qstring+'}';
                }
                setAttrs({dispwpnmxstr1: qstring});
            });
        }
        else{setAttrs({wpnselmx1: 0});}
        
        if(indirect==1){
            setAttrs({wpnselid1: 1});
            getAttrs(["dispwpnsingleshot1","dispwpnsemishot1","dispwpnautoshot1"], function(a) {
                if( (!isNaN(a.dispwpnautoshot1)) && a.dispwpnautoshot1>0 && a.dispwpnautoshot1<11){auto=true;}
                if( (!isNaN(a.dispwpnsemishot1)) && a.dispwpnsemishot1>0 && a.dispwpnsemishot1<11){semi=true;}

                if(a.dispwpnsingleshot1=='S' && semi==false && auto==false){qstring=3;}
                else if(a.dispwpnsingleshot1!='S' && semi==true && auto==false){qstring=4;}
                else if(a.dispwpnsingleshot1!='S' && semi==false && auto==true){qstring=5;}
                else {
                    qstring='?{Fire Selection(Indirect)';
                    if(a.dispwpnsingleshot1=='S'){qstring=qstring+'|Standard, 3';}
                    if(semi==true){qstring=qstring+'|Semi-Auto, 4';}
                    if(auto==true){qstring=qstring+'|Full-Auto, 5';}
                    qstring=qstring+'}';
                }
                setAttrs({dispwpnidstr1: qstring});
            });
        }
        else{setAttrs({wpnselid1: 0});}
        
        
        if(swift==1 && values.dispwpnsingleshot1=='M'){setAttrs({wpnselsw1: 1});}
        else{setAttrs({wpnselsw1: 0});}
        
        if(lightning==1 && unwieldy==0 && values.dispwpnsingleshot1=='M'){setAttrs({wpnsella1: 1});}
        else{setAttrs({wpnsella1: 0});}
        
        var tempch = values.dispwpnspecial1.replace(/,/g , ".");
        tempch = tempch.replace(/^\s+|\s+$/g, '');
        setAttrs({dispwpnspecialalt1: tempch});
        
        
    });
});
on("change:dispwpnspecial2 ", function() {
    getAttrs(["dispwpnsingleshot2","dispwpnspecial2", "talentstring"], function(values) {
        var specialArray = values.dispwpnspecial2.split(',');
        var ttArray=values.talentstring.split('.');
        var maximal=0;
        var indirect=0;
        var swift=0;
        var lightning=0;
        var unwieldy=0;
        var semi=false;
        var auto=false;
        var i;
        var qstring='';
        _.each(specialArray, function(current, i) {
            specialArray[i] = specialArray[i].replace(/^\s+|\s+$/g, '');    //remove whitespace
            specialArray[i] = specialArray[i].replace(/\(([^)]+)\)/g, '');  //remove parentheses and anything inside
            if(specialArray[i]=="Maximal"){maximal=1;}
            if(specialArray[i]=="Indirect"){indirect=1;}
            if(specialArray[i]=="Unwieldy"){unwieldy=1;}
            if(specialArray[i]=="Unbalanced"){unwieldy=1;}
        });
        
        _.each(ttArray, function(current, i) {
            ttArray[i] = ttArray[i].replace(/^\s+|\s+$/g, '');    //remove whitespace
            ttArray[i] = ttArray[i].replace(/\(([^)]+)\)/g, '');  //remove parentheses and anything inside
            if(ttArray[i]=="swiftattack"){swift=1;}
            if(ttArray[i]=="lightningattack"){lightning=1;}
        });
        
        if(maximal==1){
            setAttrs({wpnselmx2: 1});
            getAttrs(["dispwpnsingleshot2","dispwpnsemishot2","dispwpnautoshot2"], function(a) {
                if( (!isNaN(a.dispwpnautoshot2)) && a.dispwpnautoshot2>0 && a.dispwpnautoshot2<11){auto=true;}
                if( (!isNaN(a.dispwpnsemishot2)) && a.dispwpnsemishot2>0 && a.dispwpnsemishot2<11){semi=true;}

                if(a.dispwpnsingleshot2=='S' && semi==false && auto==false){qstring=6;}
                else if(a.dispwpnsingleshot2!='S' && semi==true && auto==false){qstring=7;}
                else if(a.dispwpnsingleshot2!='S' && semi==false && auto==true){qstring=8;}
                else {
                    qstring='?{Fire Selection(Maximal)';
                    if(a.dispwpnsingleshot2=='S'){qstring=qstring+'|Standard, 6';}
                    if(semi==true){qstring=qstring+'|Semi-Auto, 7';}
                    if(auto==true){qstring=qstring+'|Full-Auto, 8';}
                    qstring=qstring+'}';
                }
                setAttrs({dispwpnmxstr2: qstring});
            });
        }
        else{setAttrs({wpnselmx2: 0});}
        
        if(indirect==1){
            setAttrs({wpnselid2: 1});
            getAttrs(["dispwpnsingleshot2","dispwpnsemishot2","dispwpnautoshot2"], function(a) {
                if( (!isNaN(a.dispwpnautoshot2)) && a.dispwpnautoshot2>0 && a.dispwpnautoshot2<11){auto=true;}
                if( (!isNaN(a.dispwpnsemishot2)) && a.dispwpnsemishot2>0 && a.dispwpnsemishot2<11){semi=true;}

                if(a.dispwpnsingleshot2=='S' && semi==false && auto==false){qstring=3;}
                else if(a.dispwpnsingleshot2!='S' && semi==true && auto==false){qstring=4;}
                else if(a.dispwpnsingleshot2!='S' && semi==false && auto==true){qstring=5;}
                else {
                    qstring='?{Fire Selection(Indirect)';
                    if(a.dispwpnsingleshot2=='S'){qstring=qstring+'|Standard, 3';}
                    if(semi==true){qstring=qstring+'|Semi-Auto, 4';}
                    if(auto==true){qstring=qstring+'|Full-Auto, 5';}
                    qstring=qstring+'}';
                }
                setAttrs({dispwpnidstr2: qstring});
            });
        }
        else{setAttrs({wpnselid2: 0});}
        
        if(swift==1 && values.dispwpnsingleshot2=='M'){setAttrs({wpnselsw2: 1});}
        else{setAttrs({wpnselsw2: 0});}
        
        if(lightning==1 && unwieldy==0 && values.dispwpnsingleshot2=='M'){setAttrs({wpnsella2: 1});}
        else{setAttrs({wpnsella2: 0});}
        
        
        var tempch = values.dispwpnspecial2.replace(/,/g , ".");
        tempch = tempch.replace(/^\s+|\s+$/g, '');
        setAttrs({dispwpnspecialalt2: tempch});
    });
});
//Melee basics
on("change:dispwpnsingleshot1", function() {
    getAttrs(["dispwpnsingleshot1"], function(values) {
        var wpnid1 =  values.dispwpnsingleshot1;
        if(wpnid1 == 'M') {
            setAttrs({wpnselme1: 1, wpnselrg1: 0});
        } else{
            setAttrs({wpnselme1: 0, wpnselrg1: 1});
        }
    });
});
on("change:dispwpnsingleshot2", function() {
    getAttrs(["dispwpnsingleshot2"], function(values) {
        var wpnid1 =  values.dispwpnsingleshot2;
        if(wpnid1 == 'M') {
            setAttrs({wpnselme2: 1, wpnselrg2: 0});
        } else{
            setAttrs({wpnselme2: 0, wpnselrg2: 1});
        }
    });
});

//Psychic power special strings
on("change:disppsyspecial1 ", function() {
    getAttrs(["disppsyspecial1"], function(values) {
        
        var tempch = values.disppsyspecial1.replace(/,/g , ".");
        tempch = tempch.replace(/^\s+|\s+$/g, '');
        setAttrs({disppsyspecialalt1: tempch});
        
    });
});
on("change:disppsyspecial2 ", function() {
    getAttrs(["disppsyspecial2"], function(values) {
        
        var tempch = values.disppsyspecial2.replace(/,/g , ".");
        tempch = tempch.replace(/^\s+|\s+$/g, '');
        setAttrs({disppsyspecialalt2: tempch});
        
    });
});

///////////////////
//
//TALENT RETENTION
//
///////////////////



on("change:repeating_talents", function() {
    getSectionIDs("repeating_talents", function(idarray) {
        if(idarray.length > 0) {
            var talstr='';
            var temp;
            _.each(idarray, function(currentID, i) {
                getAttrs(["repeating_talents_"+currentID+"_talentnames"], function(x) {
                    temp =x["repeating_talents_"+currentID+"_talentnames"];
                    talstr = talstr + temp +".";
                    //setAttrs({background: talstr});
                    setAttrs({talentstring: talstr});
                });
            });
            //setAttrs({homeworld: "lol"});
        }
    });
});



///////////////////////////////////
//
//View Wpn and Pwr selection workers
//
/////////////////////////////////////



on("change:repeating_weapons:wpnselects", function() {
    getAttrs(["repeating_weapons_wpnselects"], function(v) {
        getSectionIDs("repeating_weapons", function(idarray) {
            if(idarray.length > 0) {
                var count = 0;
                _.each(idarray, function(currentID, i) {
                    getAttrs(["repeating_weapons_" + currentID + "_wpnselects"], function(x) {
                        var wpnid =  x["repeating_weapons_" + currentID + "_wpnselects"]
                        if(wpnid == 1 && count == 0) {
                            count=count+1;
                            getAttrs([
                                "repeating_weapons_" + currentID + "_wpnnames",
                                "repeating_weapons_" + currentID + "_wpnsingleshots",
                                "repeating_weapons_" + currentID + "_wpnsemishots",
                                "repeating_weapons_" + currentID + "_wpnautoshots",
                                "repeating_weapons_" + currentID + "_wpnranges",
                                "repeating_weapons_" + currentID + "_wpndmgnumdices",
                                "repeating_weapons_" + currentID + "_wpndmgdices",
                                "repeating_weapons_" + currentID + "_wpndmgstatics",
                                "repeating_weapons_" + currentID + "_wpndmgtypes",
                                "repeating_weapons_" + currentID + "_wpnpens",
                                "repeating_weapons_" + currentID + "_wpnrldtimes",
                                "repeating_weapons_" + currentID + "_wpnclipcurs",
                                "repeating_weapons_" + currentID + "_wpnclipmaxs",
                                "repeating_weapons_" + currentID + "_wpnweights",
                                "repeating_weapons_" + currentID + "_wpnqualitys",
                                "repeating_weapons_" + currentID + "_wpnrlds",
                                "repeating_weapons_" + currentID + "_wpnspecials"
                                ], function(y) {
                                setAttrs({
                                    dispwpnname1: y["repeating_weapons_" + currentID + "_wpnnames"],
                                    dispwpnsingleshot1: y["repeating_weapons_" + currentID + "_wpnsingleshots"],
                                    dispwpnsemishot1: y["repeating_weapons_" + currentID + "_wpnsemishots"],
                                    dispwpnautoshot1: y["repeating_weapons_" + currentID + "_wpnautoshots"],
                                    dispwpnrange1: y["repeating_weapons_" + currentID + "_wpnranges"],
                                    dispwpndmgnumdice1: y["repeating_weapons_" + currentID + "_wpndmgnumdices"],
                                    dispwpndmgdice1: y["repeating_weapons_" + currentID + "_wpndmgdices"],
                                    dispwpndmgstatic1: y["repeating_weapons_" + currentID + "_wpndmgstatics"],
                                    dispwpndmgtype1: y["repeating_weapons_" + currentID + "_wpndmgtypes"],
                                    dispwpnpen1: y["repeating_weapons_" + currentID + "_wpnpens"],
                                    dispwpnrldtime1: y["repeating_weapons_" + currentID + "_wpnrldtimes"],
                                    dispwpnclipcur1: y["repeating_weapons_" + currentID + "_wpnclipcurs"],
                                    dispwpnclipmax1: y["repeating_weapons_" + currentID + "_wpnclipmaxs"],
                                    dispwpnweight1: y["repeating_weapons_" + currentID + "_wpnweights"],
                                    dispwpnquality1: y["repeating_weapons_" + currentID + "_wpnqualitys"],
                                    dispwpnrld1: y["repeating_weapons_" + currentID + "_wpnrlds"],
                                    dispwpnspecial1: y["repeating_weapons_" + currentID + "_wpnspecials"]
                                });
                            });
                        }
                        else if(wpnid == 1 && count == 1) {
                            count=count+1;
                            getAttrs([
                                "repeating_weapons_" + currentID + "_wpnnames",
                                "repeating_weapons_" + currentID + "_wpnsingleshots",
                                "repeating_weapons_" + currentID + "_wpnsemishots",
                                "repeating_weapons_" + currentID + "_wpnautoshots",
                                "repeating_weapons_" + currentID + "_wpnranges",
                                "repeating_weapons_" + currentID + "_wpndmgnumdices",
                                "repeating_weapons_" + currentID + "_wpndmgdices",
                                "repeating_weapons_" + currentID + "_wpndmgstatics",
                                "repeating_weapons_" + currentID + "_wpndmgtypes",
                                "repeating_weapons_" + currentID + "_wpnpens",
                                "repeating_weapons_" + currentID + "_wpnrldtimes",
                                "repeating_weapons_" + currentID + "_wpnclipcurs",
                                "repeating_weapons_" + currentID + "_wpnclipmaxs",
                                "repeating_weapons_" + currentID + "_wpnweights",
                                "repeating_weapons_" + currentID + "_wpnqualitys",
                                "repeating_weapons_" + currentID + "_wpnrlds",
                                "repeating_weapons_" + currentID + "_wpnspecials"
                                ], function(y) {
                                setAttrs({
                                    dispwpnname2: y["repeating_weapons_" + currentID + "_wpnnames"],
                                    dispwpnsingleshot2: y["repeating_weapons_" + currentID + "_wpnsingleshots"],
                                    dispwpnsemishot2: y["repeating_weapons_" + currentID + "_wpnsemishots"],
                                    dispwpnautoshot2: y["repeating_weapons_" + currentID + "_wpnautoshots"],
                                    dispwpnrange2: y["repeating_weapons_" + currentID + "_wpnranges"],
                                    dispwpndmgnumdice2: y["repeating_weapons_" + currentID + "_wpndmgnumdices"],
                                    dispwpndmgdice2: y["repeating_weapons_" + currentID + "_wpndmgdices"],
                                    dispwpndmgstatic2: y["repeating_weapons_" + currentID + "_wpndmgstatics"],
                                    dispwpndmgtype2: y["repeating_weapons_" + currentID + "_wpndmgtypes"],
                                    dispwpnpen2: y["repeating_weapons_" + currentID + "_wpnpens"],
                                    dispwpnrldtime2: y["repeating_weapons_" + currentID + "_wpnrldtimes"],
                                    dispwpnclipcur2: y["repeating_weapons_" + currentID + "_wpnclipcurs"],
                                    dispwpnclipmax2: y["repeating_weapons_" + currentID + "_wpnclipmaxs"],
                                    dispwpnweight2: y["repeating_weapons_" + currentID + "_wpnweights"],
                                    dispwpnquality2: y["repeating_weapons_" + currentID + "_wpnqualitys"],
                                    dispwpnrld2: y["repeating_weapons_" + currentID + "_wpnrlds"],
                                    dispwpnspecial2: y["repeating_weapons_" + currentID + "_wpnspecials"]
                                });
                            });
                        }
                    });
                });
            }
        });
    });
});
//Psy Power Selector
on("change:repeating_powers:psyselects", function() {
    getAttrs(["repeating_powers_psyselects"], function(v) {
        getSectionIDs("repeating_powers", function(idarray) {
            if(idarray.length > 0) {
                var count = 0;
                _.each(idarray, function(currentID, i) {
                    getAttrs(["repeating_powers_" + currentID + "_psyselects"], function(x) {
                        var spellid =  x["repeating_powers_" + currentID + "_psyselects"]
                        if(spellid == 1 && count == 0) {
                            count=count+1;
                            getAttrs([
                                "repeating_powers_" + currentID + "_psynames",
                                "repeating_powers_" + currentID + "_psyactions",
                                "repeating_powers_" + currentID + "_psyatktypes",
                                "repeating_powers_" + currentID + "_psyranges",
                                "repeating_powers_" + currentID + "_psyfocuss",
                                "repeating_powers_" + currentID + "_psysustains",
                                "repeating_powers_" + currentID + "_psysubtypes",
                                "repeating_powers_" + currentID + "_psydmgflats",
                                "repeating_powers_" + currentID + "_psydmgstats",
                                "repeating_powers_" + currentID + "_psydmgprs",
                                "repeating_powers_" + currentID + "_psypens",
                                "repeating_powers_" + currentID + "_psypenprs",
                                "repeating_powers_" + currentID + "_psydmgtypes",
                                "repeating_powers_" + currentID + "_psyattrs",
                                "repeating_powers_" + currentID + "_psyeffects"
                                ], function(y) {
                                setAttrs({
                                    disppsyname1: y["repeating_powers_" + currentID + "_psynames"],
                                    disppsyaction1: y["repeating_powers_" + currentID + "_psyactions"],
                                    dispatktype1: y["repeating_powers_" + currentID + "_psyatktypes"],
                                    disppsyrange1: y["repeating_powers_" + currentID + "_psyranges"],
                                    disppsyfocus1: y["repeating_powers_" + currentID + "_psyfocuss"],
                                    disppsysustain1: y["repeating_powers_" + currentID + "_psysustains"],
                                    disppsysubtype1: y["repeating_powers_" + currentID + "_psysubtypes"],
                                    disppsydmgflat1: y["repeating_powers_" + currentID + "_psydmgflats"],
                                    disppsydmgstat1: y["repeating_powers_" + currentID + "_psydmgstats"],
                                    disppsydmgpr1: y["repeating_powers_" + currentID + "_psydmgprs"],
                                    disppsypen1: y["repeating_powers_" + currentID + "_psypens"],
                                    disppsypenpr1: y["repeating_powers_" + currentID + "_psypenprs"],
                                    disppsytype1: y["repeating_powers_" + currentID + "_psydmgtypes"],
                                    disppsyspecial1: y["repeating_powers_" + currentID + "_psyattrs"],
                                    disppsyeffect1: y["repeating_powers_" + currentID + "_psyeffects"]
                                });
                            });
                        }
                        else if(spellid == 1 && count == 1) {
                            count=count+1;
                            getAttrs([
                                "repeating_powers_" + currentID + "_psynames",
                                "repeating_powers_" + currentID + "_psyactions",
                                "repeating_powers_" + currentID + "_psyatktypes",
                                "repeating_powers_" + currentID + "_psyranges",
                                "repeating_powers_" + currentID + "_psyfocuss",
                                "repeating_powers_" + currentID + "_psysustains",
                                "repeating_powers_" + currentID + "_psysubtypes",
                                "repeating_powers_" + currentID + "_psydmgflats",
                                "repeating_powers_" + currentID + "_psydmgstats",
                                "repeating_powers_" + currentID + "_psydmgprs",
                                "repeating_powers_" + currentID + "_psypens",
                                "repeating_powers_" + currentID + "_psypenprs",
                                "repeating_powers_" + currentID + "_psydmgtypes",
                                "repeating_powers_" + currentID + "_psyattrs",
                                "repeating_powers_" + currentID + "_psyeffects"
                                ], function(y) {
                                setAttrs({
                                    disppsyname2: y["repeating_powers_" + currentID + "_psynames"],
                                    disppsyaction2: y["repeating_powers_" + currentID + "_psyactions"],
                                    dispatktype2: y["repeating_powers_" + currentID + "_psyatktypes"],
                                    disppsyrange2: y["repeating_powers_" + currentID + "_psyranges"],
                                    disppsyfocus2: y["repeating_powers_" + currentID + "_psyfocuss"],
                                    disppsysustain2: y["repeating_powers_" + currentID + "_psysustains"],
                                    disppsysubtype2: y["repeating_powers_" + currentID + "_psysubtypes"],
                                    disppsydmgflat2: y["repeating_powers_" + currentID + "_psydmgflats"],
                                    disppsydmgstat2: y["repeating_powers_" + currentID + "_psydmgstats"],
                                    disppsydmgpr2: y["repeating_powers_" + currentID + "_psydmgprs"],
                                    disppsypen2: y["repeating_powers_" + currentID + "_psypens"],
                                    disppsypenpr2: y["repeating_powers_" + currentID + "_psypenprs"],
                                    disppsytype2: y["repeating_powers_" + currentID + "_psydmgtypes"],
                                    disppsyspecial2: y["repeating_powers_" + currentID + "_psyattrs"],
                                    disppsyeffect2: y["repeating_powers_" + currentID + "_psyeffects"]
                                });
                            });
                        }
                    });
                });
            }
        });
    });
});



//Weight calculation worker
on("change:repeating_equipment:equipweights change:repeating_weapons:wpnweights", function() {
    getAttrs(["repeating_equipment_equipweights", "repeating_weapons_wpnweights"], function(v) {
        var weight = 0;
        getSectionIDs("repeating_equipment", function(idarray) {
            if(idarray.length > 0) {
                _.each(idarray, function(currentID, i) {
                    getAttrs(["repeating_equipment_" + currentID + "_equipweights"], function(x) {
                        weight += parseInt(x["repeating_equipment_" + currentID + "_equipweights"])
                        setAttrs({CurCapacity: weight});
                    });
                });
            }
        });
        getSectionIDs("repeating_weapons", function(idarray) {
            if(idarray.length > 0) {
                _.each(idarray, function(currentID, i) {
                    getAttrs(["repeating_weapons_" + currentID + "_wpnweights"], function(x) {
                        weight += parseInt(x["repeating_weapons_" + currentID + "_wpnweights"])
                        setAttrs({CurCapacity: weight});
                    });
                });
            }
        });
    });
});
//Equipment Display worker
on("change:repeating_equipment:equipselects", function() {
    getAttrs(["repeating_equipment_equipselects"], function(v) {
        getSectionIDs("repeating_equipment", function(idarray) {
            if(idarray.length > 0) {
                var count = 1;
                _.each(idarray, function(currentID, i) {
                    getAttrs(["repeating_equipment_" + currentID + "_equipselects"], function(x) {
                        var spellid =  x["repeating_equipment_" + currentID + "_equipselects"]
                        if(spellid == 1 && count==1) {
                            count=count+1;
                            //name="dispequipname" + count;
                            //desc="dispequipdesc" + count;
                            getAttrs(["repeating_equipment_" + currentID + "_equipnames","repeating_equipment_" + currentID + "_equipdescs"], function(y) {
                                setAttrs({
                                    dispequipname1: y["repeating_equipment_" + currentID + "_equipnames"],
                                    dispequipdesc1: y["repeating_equipment_" + currentID + "_equipdescs"]
                                    //name: y["repeating_equipment_" + currentID + "_equipnames"],
                                    //desc: y["repeating_equipment_" + currentID + "_equipdescs"]
                                });
                            });
                        }
                        else if(spellid == 1 && count==2) {
                            count=count+1;
                            getAttrs(["repeating_equipment_" + currentID + "_equipnames","repeating_equipment_" + currentID + "_equipdescs"], function(y) {
                                setAttrs({
                                    dispequipname2: y["repeating_equipment_" + currentID + "_equipnames"],
                                    dispequipdesc2: y["repeating_equipment_" + currentID + "_equipdescs"]
                                });
                            });
                        }
                        else if(spellid == 1 && count==3) {
                            count=count+1;
                            getAttrs(["repeating_equipment_" + currentID + "_equipnames","repeating_equipment_" + currentID + "_equipdescs"], function(y) {
                                setAttrs({
                                    dispequipname3: y["repeating_equipment_" + currentID + "_equipnames"],
                                    dispequipdesc3: y["repeating_equipment_" + currentID + "_equipdescs"]
                                });
                            });
                        }
                        else if(spellid == 1 && count==4) {
                            count=count+1;
                            getAttrs(["repeating_equipment_" + currentID + "_equipnames","repeating_equipment_" + currentID + "_equipdescs"], function(y) {
                                setAttrs({
                                    dispequipname4: y["repeating_equipment_" + currentID + "_equipnames"],
                                    dispequipdesc4: y["repeating_equipment_" + currentID + "_equipdescs"]
                                });
                            });
                        }
                        else if(spellid == 1 && count==5) {
                            count=count+1;
                            getAttrs(["repeating_equipment_" + currentID + "_equipnames","repeating_equipment_" + currentID + "_equipdescs"], function(y) {
                                setAttrs({
                                    dispequipname5: y["repeating_equipment_" + currentID + "_equipnames"],
                                    dispequipdesc5: y["repeating_equipment_" + currentID + "_equipdescs"]
                                });
                            });
                        }
                        else if(spellid == 1 && count==6) {
                            count=count+1;
                            getAttrs(["repeating_equipment_" + currentID + "_equipnames","repeating_equipment_" + currentID + "_equipdescs"], function(y) {
                                setAttrs({
                                    dispequipname6: y["repeating_equipment_" + currentID + "_equipnames"],
                                    dispequipdesc6: y["repeating_equipment_" + currentID + "_equipdescs"]
                                });
                            });
                        }
                        else if(spellid == 1 && count==7) {
                            count=count+1;
                            getAttrs(["repeating_equipment_" + currentID + "_equipnames","repeating_equipment_" + currentID + "_equipdescs"], function(y) {
                                setAttrs({
                                    dispequipname7: y["repeating_equipment_" + currentID + "_equipnames"],
                                    dispequipdesc7: y["repeating_equipment_" + currentID + "_equipdescs"]
                                });
                            });
                        }
                        else if(spellid == 1 && count==8) {
                            count=count+1;
                            getAttrs(["repeating_equipment_" + currentID + "_equipnames","repeating_equipment_" + currentID + "_equipdescs"], function(y) {
                                setAttrs({
                                    dispequipname8: y["repeating_equipment_" + currentID + "_equipnames"],
                                    dispequipdesc8: y["repeating_equipment_" + currentID + "_equipdescs"]
                                });
                            });
                        }
                        else if(spellid == 1 && count==9) {
                            count=count+1;
                            getAttrs(["repeating_equipment_" + currentID + "_equipnames","repeating_equipment_" + currentID + "_equipdescs"], function(y) {
                                setAttrs({
                                    dispequipname9: y["repeating_equipment_" + currentID + "_equipnames"],
                                    dispequipdesc9: y["repeating_equipment_" + currentID + "_equipdescs"]
                                });
                            });
                        }
                        else if(spellid == 1 && count==10) {
                            count=count+1;
                            getAttrs(["repeating_equipment_" + currentID + "_equipnames","repeating_equipment_" + currentID + "_equipdescs"], function(y) {
                                setAttrs({
                                    dispequipname10: y["repeating_equipment_" + currentID + "_equipnames"],
                                    dispequipdesc10: y["repeating_equipment_" + currentID + "_equipdescs"]
                                });
                            });
                        }
                    });
                });
            }
        });
    });
});
//Carrying Capacity Worker
on("change:strengthmod change:toughnessmod", function() {
    getAttrs(["StrengthMod", "ToughnessMod"], function(values) {
        
        var tempmod=10;
        tempmod=parseInt(values.StrengthMod)+parseInt(values.ToughnessMod);
        if(tempmod == 0) {tempmod=1;}
        else if(tempmod == 1) {tempmod=2;}
        else if(tempmod == 2) {tempmod=5;}
        else if(tempmod == 3) {tempmod=9;}
        else if(tempmod == 4) {tempmod=18;}
        else if(tempmod == 5) {tempmod=27;}
        else if(tempmod == 6) {tempmod=36;}
        else if(tempmod == 7) {tempmod=45;}
        else if(tempmod == 8) {tempmod=56;}
        else if(tempmod == 9) {tempmod=67;}
        else if(tempmod == 10) {tempmod=78;}
        else if(tempmod == 11) {tempmod=90;}
        else if(tempmod == 12) {tempmod=112;}
        else if(tempmod == 13) {tempmod=225;}
        else if(tempmod == 14) {tempmod=337;}
        else if(tempmod == 15) {tempmod=450;}
        else if(tempmod == 16) {tempmod=675;}
        else if(tempmod == 17) {tempmod=900;}
        else if(tempmod == 18) {tempmod=1350;}
        else if(tempmod == 19) {tempmod=1800;}
        else if(tempmod == 20) {tempmod=2250;}
        else {tempmod=-1;}
        
        setAttrs({
            MaxCapacity: ( tempmod)
        });
    });
});
//Display weapon Range calculations
on("change:dispwpnrange1 change:dispwpnrange2", function() {
    getAttrs(["dispwpnrange1", "dispwpnrange2"], function(values) {
        setAttrs({
            dispwpnshortrange1: (parseInt(values.dispwpnrange1)/2),
            dispwpnlongrange1:  (parseInt(values.dispwpnrange1)*2),
            dispwpnextrange1:   (parseInt(values.dispwpnrange1)*3),
            dispwpnshortrange2: (parseInt(values.dispwpnrange1)/2),
            dispwpnlongrange2:  (parseInt(values.dispwpnrange1)*2),
            dispwpnextrange2:   (parseInt(values.dispwpnrange1)*3)
        });
    });
});



//Characteristic Modifier Workers
on("change:weaponskill change:weaponskilladj change:weaponskillunnat", function() {
    getAttrs(["WeaponSkill", "WeaponSkilladj", "WeaponSkillUnnat"], function(values) {
        setAttrs({
            WeaponSkillMod: Math.floor(((parseInt(values.WeaponSkill)+parseInt(values.WeaponSkilladj))/10)+parseInt(values.WeaponSkillUnnat))
        });
    });
});
on("change:ballisticskill change:ballisticskilladj change:ballisticskillunnat", function() {
    getAttrs(["BallisticSkill", "BallisticSkilladj", "BallisticSkillUnnat"], function(values) {
        setAttrs({
            BallisticSkillMod: Math.floor(((parseInt(values.BallisticSkill)+parseInt(values.BallisticSkilladj))/10)+parseInt(values.BallisticSkillUnnat))
        });
    });
});
on("change:strength change:strengthadj change:strengthunnat", function() {
    getAttrs(["Strength", "Strengthadj", "StrengthUnnat"], function(values) {
        setAttrs({
            StrengthMod: Math.floor(((parseInt(values.Strength)+parseInt(values.Strengthadj))/10)+parseInt(values.StrengthUnnat))
        });
    });
});
on("change:toughness change:toughnessadj change:toughnessunnat", function() {
    getAttrs(["Toughness", "Toughnessadj", "ToughnessUnnat"], function(values) {
        setAttrs({
            ToughnessMod: Math.floor(((parseInt(values.Toughness)+parseInt(values.Toughnessadj))/10)+parseInt(values.ToughnessUnnat))
        });
    });
});
on("change:agility change:agilityadj change:agilityunnat", function() {
    getAttrs(["Agility", "Agilityadj", "AgilityUnnat"], function(values) {
        setAttrs({
            AgilityMod: Math.floor(((parseInt(values.Agility)+parseInt(values.Agilityadj))/10)+parseInt(values.AgilityUnnat))
        });
    });
});
on("change:intelligence change:intelligenceadj change:intelligenceunnat", function() {
    getAttrs(["Intelligence", "Intelligenceadj", "IntelligenceUnnat"], function(values) {
        setAttrs({
            IntelligenceMod: Math.floor(((parseInt(values.Intelligence)+parseInt(values.Intelligenceadj))/10)+parseInt(values.IntelligenceUnnat))
        });
    });
});
on("change:perception change:perceptionadj change:perceptionunnat", function() {
    getAttrs(["Perception", "Perceptionadj", "PerceptionUnnat"], function(values) {
        setAttrs({
            PerceptionMod: Math.floor(((parseInt(values.Perception)+parseInt(values.Perceptionadj))/10)+parseInt(values.PerceptionUnnat))
        });
    });
});
on("change:willpower change:willpoweradj change:willpowerunnat", function() {
    getAttrs(["Willpower", "Willpoweradj", "WillpowerUnnat"], function(values) {
        setAttrs({
            WillpowerMod: Math.floor(((parseInt(values.Willpower)+parseInt(values.Willpoweradj))/10)+parseInt(values.WillpowerUnnat))
        });
    });
});
on("change:fellowship change:fellowshipadj change:fellowshipunnat", function() {
    getAttrs(["Fellowship", "Fellowshipadj", "FellowshipUnnat"], function(values) {
        setAttrs({
            FellowshipMod: Math.floor(((parseInt(values.Fellowship)+parseInt(values.Fellowshipadj))/10)+parseInt(values.FellowshipUnnat))
        });
    });
});
on("change:influence change:influenceadj change:influenceunnat", function() {
    getAttrs(["Influence", "Influenceadj", "InfluenceUnnat"], function(values) {
        setAttrs({
            InfluenceMod: Math.floor(((parseInt(values.Influence)+parseInt(values.Influenceadj))/10)+parseInt(values.InfluenceUnnat))
        });
    });
});



//Skill Score Workers
on("change:agility change:agilityadj change:acrobaticsranks change:acrobaticsmisc", function() {
    getAttrs(["Agility", "Agilityadj", "AcrobaticsRanks", "AcrobaticsMisc"], function(values) {
        var tempmod=10;
        tempmod=parseInt(values.AcrobaticsRanks);
        if(tempmod == 0) {tempmod=-20;}
        else if (tempmod==1 || tempmod==2 || tempmod==3 || tempmod==4) {tempmod=(tempmod-1)*10;}
        else {tempmod=-900;}
        setAttrs({
            AcrobaticsScore: (parseInt(values.Agility) + parseInt(values.Agilityadj) + parseInt(values.AcrobaticsMisc) + tempmod)
        });
    });
});
on("change:strength change:strengthadj change:athleticsranks change:athleticsmisc", function() {
    getAttrs(["Strength", "Strengthadj", "AthleticsRanks", "AthleticsMisc"], function(values) {
        var tempmod=10;
        tempmod=parseInt(values.AthleticsRanks);
        if(tempmod == 0) {tempmod=-20;}
        else if (tempmod==1 || tempmod==2 || tempmod==3 || tempmod==4) {tempmod=(tempmod-1)*10;}
        else {tempmod=-900;}
        setAttrs({
            AthleticsScore: (parseInt(values.Strength) + parseInt(values.Strengthadj) + parseInt(values.AthleticsMisc) + tempmod)
        });
    });
});
on("change:perception change:perceptionadj change:awarenessranks change:awarenessmisc", function() {
    getAttrs(["Perception", "Perceptionadj", "AwarenessRanks", "AwarenessMisc"], function(values) {
        var tempmod=10;
        tempmod=parseInt(values.AwarenessRanks);
        if(tempmod == 0) {tempmod=-20;}
        else if (tempmod==1 || tempmod==2 || tempmod==3 || tempmod==4) {tempmod=(tempmod-1)*10;}
        else {tempmod=-900;}
        setAttrs({
            AwarenessScore: (parseInt(values.Perception) + parseInt(values.Perceptionadj) + parseInt(values.AwarenessMisc) + tempmod)
        });
    });
});
on("change:fellowship change:fellowshipadj change:charmranks change:charmmisc", function() {
    getAttrs(["Fellowship", "Fellowshipadj", "CharmRanks", "CharmMisc"], function(values) {
        var tempmod=10;
        tempmod=parseInt(values.CharmRanks);
        if(tempmod == 0) {tempmod=-20;}
        else if (tempmod==1 || tempmod==2 || tempmod==3 || tempmod==4) {tempmod=(tempmod-1)*10;}
        else {tempmod=-900;}
        setAttrs({
            CharmScore: (parseInt(values.Fellowship) + parseInt(values.Fellowshipadj) + parseInt(values.CharmMisc) + tempmod)
        });
    });
});
on("change:fellowship change:fellowshipadj change:commandranks change:commandmisc", function() {
    getAttrs(["Fellowship", "Fellowshipadj", "CommandRanks", "CommandMisc"], function(values) {
        var tempmod=10;
        tempmod=parseInt(values.CommandRanks);
        if(tempmod == 0) {tempmod=-20;}
        else if (tempmod==1 || tempmod==2 || tempmod==3 || tempmod==4) {tempmod=(tempmod-1)*10;}
        else {tempmod=-900;}
        setAttrs({
            CommandScore: (parseInt(values.Fellowship) + parseInt(values.Fellowshipadj) + parseInt(values.CommandMisc) + tempmod)
        });
    });
});
on("change:fellowship change:fellowshipadj change:commerceranks change:commercemisc", function() {
    getAttrs(["Fellowship", "Fellowshipadj", "CommerceRanks", "CommerceMisc"], function(values) {
        var tempmod=10;
        tempmod=parseInt(values.CommerceRanks);
        if(tempmod == 0) {tempmod=-20;}
        else if (tempmod==1 || tempmod==2 || tempmod==3 || tempmod==4) {tempmod=(tempmod-1)*10;}
        else {tempmod=-900;}
        setAttrs({
            CommerceScore: (parseInt(values.Fellowship) + parseInt(values.Fellowshipadj) + parseInt(values.CommerceMisc) + tempmod)
        });
    });
});
on("change:fellowship change:fellowshipadj change:deceiveranks change:deceivemisc", function() {
    getAttrs(["Fellowship", "Fellowshipadj", "DeceiveRanks", "DeceiveMisc"], function(values) {
        var tempmod=10;
        tempmod=parseInt(values.DeceiveRanks);
        if(tempmod == 0) {tempmod=-20;}
        else if (tempmod==1 || tempmod==2 || tempmod==3 || tempmod==4) {tempmod=(tempmod-1)*10;}
        else {tempmod=-900;}
        setAttrs({
            DeceiveScore: (parseInt(values.Fellowship) + parseInt(values.Fellowshipadj) + parseInt(values.DeceiveMisc) + tempmod)
        });
    });
});
on("change:agility change:agilityadj change:dodgeranks change:dodgemisc", function() {
    getAttrs(["Agility", "Agilityadj", "DodgeRanks", "DodgeMisc"], function(values) {
        var tempmod=10;
        tempmod=parseInt(values.DodgeRanks);
        if(tempmod == 0) {tempmod=-20;}
        else if (tempmod==1 || tempmod==2 || tempmod==3 || tempmod==4) {tempmod=(tempmod-1)*10;}
        else {tempmod=-900;}
        setAttrs({
            DodgeScore: (parseInt(values.Agility) + parseInt(values.Agilityadj) + parseInt(values.DodgeMisc) + tempmod)
        });
    });
});
on("change:fellowship change:fellowshipadj change:inquiryranks change:inquirymisc", function() {
    getAttrs(["Fellowship", "Fellowshipadj", "InquiryRanks", "InquiryMisc"], function(values) {
        var tempmod=10;
        tempmod=parseInt(values.InquiryRanks);
        if(tempmod == 0) {tempmod=-20;}
        else if (tempmod==1 || tempmod==2 || tempmod==3 || tempmod==4) {tempmod=(tempmod-1)*10;}
        else {tempmod=-900;}
        setAttrs({
            InquiryScore: (parseInt(values.Fellowship) + parseInt(values.Fellowshipadj) + parseInt(values.InquiryMisc) + tempmod)
        });
    });
});
on("change:willpower change:willpoweradj change:interrogationranks change:interrogationmisc", function() {
    getAttrs(["Willpower", "Willpoweradj", "InterrogationRanks", "InterrogationMisc"], function(values) {
        var tempmod=10;
        tempmod=parseInt(values.InterrogationRanks);
        if(tempmod == 0) {tempmod=-20;}
        else if (tempmod==1 || tempmod==2 || tempmod==3 || tempmod==4) {tempmod=(tempmod-1)*10;}
        else {tempmod=-900;}
        setAttrs({
            InterrogationScore: (parseInt(values.Willpower) + parseInt(values.Willpoweradj) + parseInt(values.InterrogationMisc) + tempmod)
        });
    });
});
on("change:strength change:strengthadj change:intimidateranks change:intimidatemisc", function() {
    getAttrs(["Strength", "Strengthadj", "IntimidateRanks", "IntimidateMisc"], function(values) {
        var tempmod=10;
        tempmod=parseInt(values.IntimidateRanks);
        if(tempmod == 0) {tempmod=-20;}
        else if (tempmod==1 || tempmod==2 || tempmod==3 || tempmod==4) {tempmod=(tempmod-1)*10;}
        else {tempmod=-900;}
        setAttrs({
            IntimidateScore: (parseInt(values.Strength) + parseInt(values.Strengthadj) + parseInt(values.IntimidateMisc) + tempmod)
        });
    });
});
on("change:intelligence change:intelligenceadj change:logicranks change:logicmisc", function() {
    getAttrs(["Intelligence", "Intelligenceadj", "LogicRanks", "LogicMisc"], function(values) {
        var tempmod=10;
        tempmod=parseInt(values.LogicRanks);
        if(tempmod == 0) {tempmod=-20;}
        else if (tempmod==1 || tempmod==2 || tempmod==3 || tempmod==4) {tempmod=(tempmod-1)*10;}
        else {tempmod=-900;}
        setAttrs({
            LogicScore: (parseInt(values.Intelligence) + parseInt(values.Intelligenceadj) + parseInt(values.LogicMisc) + tempmod)
        });
    });
});
on("change:intelligence change:intelligenceadj change:medicaeranks change:medicaemisc", function() {
    getAttrs(["Intelligence", "Intelligenceadj", "MedicaeRanks", "MedicaeMisc"], function(values) {
        var tempmod=10;
        tempmod=parseInt(values.MedicaeRanks);
        if(tempmod == 0) {tempmod=-20;}
        else if (tempmod==1 || tempmod==2 || tempmod==3 || tempmod==4) {tempmod=(tempmod-1)*10;}
        else {tempmod=-900;}
        setAttrs({
            MedicaeScore: (parseInt(values.Intelligence) + parseInt(values.Intelligenceadj) + parseInt(values.MedicaeMisc) + tempmod)
        });
    });
});
on("change:intelligence change:intelligenceadj change:nvsurfaceranks change:nvsurfacemisc", function() {
    getAttrs(["Intelligence", "Intelligenceadj", "NvSurfaceRanks", "NvSurfaceMisc"], function(values) {
        var tempmod=10;
        tempmod=parseInt(values.NvSurfaceRanks);
        if(tempmod == 0) {tempmod=-20;}
        else if (tempmod==1 || tempmod==2 || tempmod==3 || tempmod==4) {tempmod=(tempmod-1)*10;}
        else {tempmod=-900;}
        setAttrs({
            NvSurfaceScore: (parseInt(values.Intelligence) + parseInt(values.Intelligenceadj) + parseInt(values.NvSurfaceMisc) + tempmod)
        });
    });
});
on("change:intelligence change:intelligenceadj change:nvstellarranks change:nvstellarmisc", function() {
    getAttrs(["Intelligence", "Intelligenceadj", "NvStellarRanks", "NvStellarMisc"], function(values) {
        var tempmod=10;
        tempmod=parseInt(values.NvStellarRanks);
        if(tempmod == 0) {tempmod=-20;}
        else if (tempmod==1 || tempmod==2 || tempmod==3 || tempmod==4) {tempmod=(tempmod-1)*10;}
        else {tempmod=-900;}
        setAttrs({
            NvStellarScore: (parseInt(values.Intelligence) + parseInt(values.Intelligenceadj) + parseInt(values.NvStellarMisc) + tempmod)
        });
    });
});
on("change:intelligence change:intelligenceadj change:nvwarpranks change:nvwarpmisc", function() {
    getAttrs(["Intelligence", "Intelligenceadj", "NvWarpRanks", "NvWarpMisc"], function(values) {
        var tempmod=10;
        tempmod=parseInt(values.NvWarpRanks);
        if(tempmod == 0) {tempmod=-20;}
        else if (tempmod==1 || tempmod==2 || tempmod==3 || tempmod==4) {tempmod=(tempmod-1)*10;}
        else {tempmod=-900;}
        setAttrs({
            NvWarpScore: (parseInt(values.Intelligence) + parseInt(values.Intelligenceadj) + parseInt(values.NvWarpMisc) + tempmod)
        });
    });
});
on("change:agility change:agilityadj change:opaeronauticaranks change:opaeronauticamisc", function() {
    getAttrs(["Agility", "Agilityadj", "OpAeronauticaRanks", "OpAeronauticaMisc"], function(values) {
        var tempmod=10;
        tempmod=parseInt(values.OpAeronauticaRanks);
        if(tempmod == 0) {tempmod=-20;}
        else if (tempmod==1 || tempmod==2 || tempmod==3 || tempmod==4) {tempmod=(tempmod-1)*10;}
        else {tempmod=-900;}
        setAttrs({
            OpAeronauticaScore: (parseInt(values.Agility) + parseInt(values.Agilityadj) + parseInt(values.OpAeronauticaMisc) + tempmod)
        });
    });
});
on("change:agility change:agilityadj change:opsurfaceranks change:opsurfacemisc", function() {
    getAttrs(["Agility", "Agilityadj", "OpSurfaceRanks", "OpSurfaceMisc"], function(values) {
        var tempmod=10;
        tempmod=parseInt(values.OpSurfaceRanks);
        if(tempmod == 0) {tempmod=-20;}
        else if (tempmod==1 || tempmod==2 || tempmod==3 || tempmod==4) {tempmod=(tempmod-1)*10;}
        else {tempmod=-900;}
        setAttrs({
            OpSurfaceScore: (parseInt(values.Agility) + parseInt(values.Agilityadj) + parseInt(values.OpSurfaceMisc) + tempmod)
        });
    });
});
on("change:agility change:agilityadj change:opvoidshipranks change:opvoidshipdmisc", function() {
    getAttrs(["Agility", "Agilityadj", "OpVoidshipRanks", "OpVoidshipMisc"], function(values) {
        var tempmod=10;
        tempmod=parseInt(values.OpVoidshipRanks);
        if(tempmod == 0) {tempmod=-20;}
        else if (tempmod==1 || tempmod==2 || tempmod==3 || tempmod==4) {tempmod=(tempmod-1)*10;}
        else {tempmod=-900;}
        setAttrs({
            OpVoidshipScore: (parseInt(values.Agility) + parseInt(values.Agilityadj) + parseInt(values.OpVoidshipMisc) + tempmod)
        });
    });
});
on("change:weaponskill change:weaponskilladj change:parryranks change:parrymisc", function() {
    getAttrs(["WeaponSkill", "WeaponSkilladj", "ParryRanks", "ParryMisc"], function(values) {
        var tempmod=10;
        tempmod=parseInt(values.ParryRanks);
        if(tempmod == 0) {tempmod=-20;}
        else if (tempmod==1 || tempmod==2 || tempmod==3 || tempmod==4) {tempmod=(tempmod-1)*10;}
        else {tempmod=-900;}
        setAttrs({
            ParryScore: (parseInt(values.WeaponSkill) + parseInt(values.WeaponSkilladj) + parseInt(values.ParryMisc) + tempmod)
        });
    });
});
on("change:willpower change:willpoweradj change:psyniscienceranks change:psynisciencemisc", function() {
    getAttrs(["Willpower", "Willpoweradj", "PsyniscienceRanks", "PsyniscienceMisc"], function(values) {
        var tempmod=10;
        tempmod=parseInt(values.PsyniscienceRanks);
        if(tempmod == 0) {tempmod=-20;}
        else if (tempmod==1 || tempmod==2 || tempmod==3 || tempmod==4) {tempmod=(tempmod-1)*10;}
        else {tempmod=-900;}
        setAttrs({
            PsyniscienceScore: (parseInt(values.Willpower) + parseInt(values.Willpoweradj) + parseInt(values.PsyniscienceMisc) + tempmod)
        });
    });
});
on("change:perception change:perceptionadj change:scrutinyranks change:scrutinymisc", function() {
    getAttrs(["Perception", "Perceptionadj", "ScrutinyRanks", "ScrutinyMisc"], function(values) {
        var tempmod=10;
        tempmod=parseInt(values.ScrutinyRanks);
        if(tempmod == 0) {tempmod=-20;}
        else if (tempmod==1 || tempmod==2 || tempmod==3 || tempmod==4) {tempmod=(tempmod-1)*10;}
        else {tempmod=-900;}
        setAttrs({
            ScrutinyScore: (parseInt(values.Perception) + parseInt(values.Perceptionadj) + parseInt(values.ScrutinyMisc) + tempmod)
        });
    });
});
on("change:intelligence change:intelligenceadj change:securityranks change:securitymisc", function() {
    getAttrs(["Intelligence", "Intelligenceadj", "SecurityRanks", "SecurityMisc"], function(values) {
        var tempmod=10;
        tempmod=parseInt(values.SecurityRanks);
        if(tempmod == 0) {tempmod=-20;}
        else if (tempmod==1 || tempmod==2 || tempmod==3 || tempmod==4) {tempmod=(tempmod-1)*10;}
        else {tempmod=-900;}
        setAttrs({
            SecurityScore: (parseInt(values.Intelligence) + parseInt(values.Intelligenceadj) + parseInt(values.SecurityMisc) + tempmod)
        });
    });
});
on("change:agility change:agilityadj change:sleightofhandranks change:sleightofhandmisc", function() {
    getAttrs(["Agility", "Agilityadj", "SleightOfHandRanks", "SleightOfHandMisc"], function(values) {
        var tempmod=10;
        tempmod=parseInt(values.SleightOfHandRanks);
        if(tempmod == 0) {tempmod=-20;}
        else if (tempmod==1 || tempmod==2 || tempmod==3 || tempmod==4) {tempmod=(tempmod-1)*10;}
        else {tempmod=-900;}
        setAttrs({
            SleightOfHandScore: (parseInt(values.Agility) + parseInt(values.Agilityadj) + parseInt(values.SleightOfHandMisc) + tempmod)
        });
    });
});
on("change:agility change:agilityadj change:stealthranks change:stealthmisc", function() {
    getAttrs(["Agility", "Agilityadj", "StealthRanks", "StealthMisc"], function(values) {
        var tempmod=10;
        tempmod=parseInt(values.StealthRanks);
        if(tempmod == 0) {tempmod=-20;}
        else if (tempmod==1 || tempmod==2 || tempmod==3 || tempmod==4) {tempmod=(tempmod-1)*10;}
        else {tempmod=-900;}
        setAttrs({
            StealthScore: (parseInt(values.Agility) + parseInt(values.Agilityadj) + parseInt(values.StealthMisc) + tempmod)
        });
    });
});
on("change:perception change:perceptionadj change:survivalranks change:survivalmisc", function() {
    getAttrs(["Perception", "Perceptionadj", "SurvivalRanks", "SurvivalMisc"], function(values) {
        var tempmod=10;
        tempmod=parseInt(values.SurvivalRanks);
        if(tempmod == 0) {tempmod=-20;}
        else if (tempmod==1 || tempmod==2 || tempmod==3 || tempmod==4) {tempmod=(tempmod-1)*10;}
        else {tempmod=-900;}
        setAttrs({
            SurvivalScore: (parseInt(values.Perception) + parseInt(values.Perceptionadj) + parseInt(values.SurvivalMisc) + tempmod)
        });
    });
});
on("change:intelligence change:intelligenceadj change:techuseranks change:techusemisc", function() {
    getAttrs(["Intelligence", "Intelligenceadj", "TechUseRanks", "TechUseMisc"], function(values) {
        var tempmod=10;
        tempmod=parseInt(values.TechUseRanks);
        if(tempmod == 0) {tempmod=-20;}
        else if (tempmod==1 || tempmod==2 || tempmod==3 || tempmod==4) {tempmod=(tempmod-1)*10;}
        else {tempmod=-900;}
        setAttrs({
            TechUseScore: (parseInt(values.Intelligence) + parseInt(values.Intelligenceadj) + parseInt(values.TechUseMisc) + tempmod)
        });
    });
});
on("change:intelligence change:intelligenceadj change:traderanks change:trademisc", function() {
    getAttrs(["Intelligence", "Intelligenceadj", "TradeRanks", "TradeMisc"], function(values) {
        var tempmod=10;
        tempmod=parseInt(values.TradeRanks);
        if(tempmod == 0) {tempmod=-20;}
        else if (tempmod==1 || tempmod==2 || tempmod==3 || tempmod==4) {tempmod=(tempmod-1)*10;}
        else {tempmod=-900;}
        setAttrs({
            TradeScore: (parseInt(values.Intelligence) + parseInt(values.Intelligenceadj) + parseInt(values.TradeMisc) + tempmod)
        });
    });
});
</script>
